<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Vue Property Decorator | WolfBerry</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="WolfBerry's Blog">
    
    <link rel="preload" href="/Blog/assets/css/0.styles.582bb75b.css" as="style"><link rel="preload" href="/Blog/assets/js/app.26c94a5c.js" as="script"><link rel="preload" href="/Blog/assets/js/2.b2fff99d.js" as="script"><link rel="preload" href="/Blog/assets/js/46.7f053f0a.js" as="script"><link rel="prefetch" href="/Blog/assets/js/10.07ed30bc.js"><link rel="prefetch" href="/Blog/assets/js/11.4405ba45.js"><link rel="prefetch" href="/Blog/assets/js/12.21f3d656.js"><link rel="prefetch" href="/Blog/assets/js/13.6282d122.js"><link rel="prefetch" href="/Blog/assets/js/14.6d0c4961.js"><link rel="prefetch" href="/Blog/assets/js/15.4904075b.js"><link rel="prefetch" href="/Blog/assets/js/16.3318e70c.js"><link rel="prefetch" href="/Blog/assets/js/17.126dec48.js"><link rel="prefetch" href="/Blog/assets/js/18.f3baeba3.js"><link rel="prefetch" href="/Blog/assets/js/19.d9a0b707.js"><link rel="prefetch" href="/Blog/assets/js/20.4b9c544c.js"><link rel="prefetch" href="/Blog/assets/js/21.82d0e7f1.js"><link rel="prefetch" href="/Blog/assets/js/22.42b8ae09.js"><link rel="prefetch" href="/Blog/assets/js/23.c676b601.js"><link rel="prefetch" href="/Blog/assets/js/24.6e1c47f1.js"><link rel="prefetch" href="/Blog/assets/js/25.310dad1a.js"><link rel="prefetch" href="/Blog/assets/js/26.a7745fbc.js"><link rel="prefetch" href="/Blog/assets/js/27.e451bb4b.js"><link rel="prefetch" href="/Blog/assets/js/28.51707047.js"><link rel="prefetch" href="/Blog/assets/js/29.edfaf11e.js"><link rel="prefetch" href="/Blog/assets/js/3.60a6da4e.js"><link rel="prefetch" href="/Blog/assets/js/30.e25e4396.js"><link rel="prefetch" href="/Blog/assets/js/31.c06c845b.js"><link rel="prefetch" href="/Blog/assets/js/32.cdc8bf6c.js"><link rel="prefetch" href="/Blog/assets/js/33.3de22c63.js"><link rel="prefetch" href="/Blog/assets/js/34.b56e280b.js"><link rel="prefetch" href="/Blog/assets/js/35.4d6ccb74.js"><link rel="prefetch" href="/Blog/assets/js/36.a729c293.js"><link rel="prefetch" href="/Blog/assets/js/37.48a8f1df.js"><link rel="prefetch" href="/Blog/assets/js/38.69b10e03.js"><link rel="prefetch" href="/Blog/assets/js/39.62484b18.js"><link rel="prefetch" href="/Blog/assets/js/4.8dfc73e1.js"><link rel="prefetch" href="/Blog/assets/js/40.7b5c5c55.js"><link rel="prefetch" href="/Blog/assets/js/41.73c45021.js"><link rel="prefetch" href="/Blog/assets/js/42.9f3fc2e2.js"><link rel="prefetch" href="/Blog/assets/js/43.a4bee912.js"><link rel="prefetch" href="/Blog/assets/js/44.acb8c2a6.js"><link rel="prefetch" href="/Blog/assets/js/45.d02eb0a9.js"><link rel="prefetch" href="/Blog/assets/js/47.46c8786e.js"><link rel="prefetch" href="/Blog/assets/js/48.19b67883.js"><link rel="prefetch" href="/Blog/assets/js/49.ce6aa35d.js"><link rel="prefetch" href="/Blog/assets/js/5.b9636d6c.js"><link rel="prefetch" href="/Blog/assets/js/50.2497754c.js"><link rel="prefetch" href="/Blog/assets/js/51.e1c78dcc.js"><link rel="prefetch" href="/Blog/assets/js/52.89262c74.js"><link rel="prefetch" href="/Blog/assets/js/53.47860fb3.js"><link rel="prefetch" href="/Blog/assets/js/54.4d1f45ac.js"><link rel="prefetch" href="/Blog/assets/js/55.b2dac113.js"><link rel="prefetch" href="/Blog/assets/js/56.34c7045e.js"><link rel="prefetch" href="/Blog/assets/js/57.d614f134.js"><link rel="prefetch" href="/Blog/assets/js/58.e88fc109.js"><link rel="prefetch" href="/Blog/assets/js/59.d386972e.js"><link rel="prefetch" href="/Blog/assets/js/6.e72b2b73.js"><link rel="prefetch" href="/Blog/assets/js/60.a3d054ef.js"><link rel="prefetch" href="/Blog/assets/js/61.27b0d020.js"><link rel="prefetch" href="/Blog/assets/js/62.742bc712.js"><link rel="prefetch" href="/Blog/assets/js/63.0cf87451.js"><link rel="prefetch" href="/Blog/assets/js/64.ee8cefe2.js"><link rel="prefetch" href="/Blog/assets/js/65.2a3e00d6.js"><link rel="prefetch" href="/Blog/assets/js/66.c16d7376.js"><link rel="prefetch" href="/Blog/assets/js/67.22d5664d.js"><link rel="prefetch" href="/Blog/assets/js/68.3163821e.js"><link rel="prefetch" href="/Blog/assets/js/69.ba149287.js"><link rel="prefetch" href="/Blog/assets/js/7.8d9b6daa.js"><link rel="prefetch" href="/Blog/assets/js/70.79b3941c.js"><link rel="prefetch" href="/Blog/assets/js/71.9633a5fc.js"><link rel="prefetch" href="/Blog/assets/js/72.0a582a8b.js"><link rel="prefetch" href="/Blog/assets/js/8.f72dab87.js"><link rel="prefetch" href="/Blog/assets/js/9.db5433a8.js">
    <link rel="stylesheet" href="/Blog/assets/css/0.styles.582bb75b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Blog/" class="home-link router-link-active"><!----> <span class="site-name">WolfBerry</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Blog/blog/" class="nav-link router-link-active">
  Blog
</a></div><div class="nav-item"><a href="/Blog/ugly/" class="nav-link">
  Ugly
</a></div><div class="nav-item"><a href="/Blog/gold/" class="nav-link">
  Gold
</a></div><div class="nav-item"><a href="/Blog/diary/" class="nav-link">
  Diary
</a></div> <a href="https://github.com/Real102/Blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Blog/blog/" class="nav-link router-link-active">
  Blog
</a></div><div class="nav-item"><a href="/Blog/ugly/" class="nav-link">
  Ugly
</a></div><div class="nav-item"><a href="/Blog/gold/" class="nav-link">
  Gold
</a></div><div class="nav-item"><a href="/Blog/diary/" class="nav-link">
  Diary
</a></div> <a href="https://github.com/Real102/Blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>博客</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Blog/blog/" aria-current="page" class="sidebar-link">介绍</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>HTML</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Blog/blog/html/meta.html" class="sidebar-link">常用的meta标签</a></li><li><a href="/Blog/blog/html/unicode.html" class="sidebar-link">字符编码</a></li><li><a href="/Blog/blog/html/font.html" class="sidebar-link">【字体压缩】淦，以后不用怕字体文件了</a></li><li><a href="/Blog/blog/html/vh.html" class="sidebar-link">vh 高度问题</a></li><li><a href="/Blog/blog/html/scss.html" class="sidebar-link">scss 常见用法</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Javascript</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Blog/blog/javascript/get-image-size.html" class="sidebar-link">限制上传图片的尺寸</a></li><li><a href="/Blog/blog/javascript/preload-image.html" class="sidebar-link">图片预加载</a></li><li><a href="/Blog/blog/javascript/lazyload.html" class="sidebar-link">图片懒加载的两种实现方式</a></li><li><a href="/Blog/blog/javascript/encryption.html" class="sidebar-link">常用的加密方案及相关实现代码</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Typescript</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Blog/blog/typescript/practice.html" class="sidebar-link">TS练习题</a></li><li><a href="/Blog/blog/typescript/extends.html" class="sidebar-link">TS 中的 extends 关键字</a></li><li><a href="/Blog/blog/typescript/built-in.html" class="sidebar-link">TS 常用内置类型</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Vue</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Blog/blog/vue/img-in-vue.html" class="sidebar-link">在vue项目中引入图片</a></li><li><a href="/Blog/blog/vue/vue-env.html" class="sidebar-link">vue 环境变量的设置与使用</a></li><li><a href="/Blog/blog/vue/decorator.html" aria-current="page" class="active sidebar-link">Vue Property Decorator</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Blog/blog/vue/decorator.html#prop" class="sidebar-link">@Prop</a></li><li class="sidebar-sub-header"><a href="/Blog/blog/vue/decorator.html#propsync" class="sidebar-link">@PropSync</a></li><li class="sidebar-sub-header"><a href="/Blog/blog/vue/decorator.html#model" class="sidebar-link">@Model</a></li><li class="sidebar-sub-header"><a href="/Blog/blog/vue/decorator.html#modelsync" class="sidebar-link">@ModelSync</a></li><li class="sidebar-sub-header"><a href="/Blog/blog/vue/decorator.html#watch" class="sidebar-link">@Watch</a></li><li class="sidebar-sub-header"><a href="/Blog/blog/vue/decorator.html#computed" class="sidebar-link">Computed</a></li><li class="sidebar-sub-header"><a href="/Blog/blog/vue/decorator.html#provide、-inject" class="sidebar-link">@Provide、@Inject</a></li><li class="sidebar-sub-header"><a href="/Blog/blog/vue/decorator.html#emit" class="sidebar-link">@Emit</a></li><li class="sidebar-sub-header"><a href="/Blog/blog/vue/decorator.html#vuex-class" class="sidebar-link">Vuex-Class</a></li><li class="sidebar-sub-header"><a href="/Blog/blog/vue/decorator.html#vuex-module-decorators-起步" class="sidebar-link">vuex-module-decorators 起步</a></li><li class="sidebar-sub-header"><a href="/Blog/blog/vue/decorator.html#state" class="sidebar-link">State</a></li><li class="sidebar-sub-header"><a href="/Blog/blog/vue/decorator.html#mutation" class="sidebar-link">@Mutation</a></li><li class="sidebar-sub-header"><a href="/Blog/blog/vue/decorator.html#getter" class="sidebar-link">Getter</a></li><li class="sidebar-sub-header"><a href="/Blog/blog/vue/decorator.html#action" class="sidebar-link">@Action</a></li><li class="sidebar-sub-header"><a href="/Blog/blog/vue/decorator.html#mutationactions" class="sidebar-link">@MutationActions</a></li><li class="sidebar-sub-header"><a href="/Blog/blog/vue/decorator.html#dynamic-module" class="sidebar-link">Dynamic Module</a></li><li class="sidebar-sub-header"><a href="/Blog/blog/vue/decorator.html#结尾" class="sidebar-link">结尾</a></li></ul></li><li><a href="/Blog/blog/vue/wechat-auth.html" class="sidebar-link">微信 JS-SDK 实现自定义分享功能</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Webpack</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Blog/blog/webpack/require-context.html" class="sidebar-link">require.context 的妙用</a></li><li><a href="/Blog/blog/webpack/lodash.html" class="sidebar-link">lodash 按需引入及打包优化</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>工具/插件</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Blog/blog/plugin/rrweb.html" class="sidebar-link">rrweb -- 录制并回放web界面用户操作</a></li><li><a href="/Blog/blog/plugin/puppeteer.html" class="sidebar-link">Puppeteer</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>移动端</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Blog/blog/mobile/preview-on-mobile.html" class="sidebar-link">手机端预览vue项目</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>其他</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Blog/blog/others/onlineTime.html" class="sidebar-link">用户在线时长统计方案思考</a></li><li><a href="/Blog/blog/others/test-unit.html" class="sidebar-link">单元测试</a></li><li><a href="/Blog/blog/others/quickapp.html" class="sidebar-link">快应用的填坑日志</a></li><li><a href="/Blog/blog/others/miniApp.html" class="sidebar-link">小程序探究</a></li><li><a href="/Blog/blog/others/nvm.html" class="sidebar-link">使用 nvm 来管理 npm</a></li><li><a href="/Blog/blog/others/vscode-for-web.html" class="sidebar-link">搭建 web 版 vs code</a></li><li><a href="/Blog/blog/others/ws-in-vscode.html" class="sidebar-link">研究vscode中的websocket</a></li><li><a href="/Blog/blog/others/format-phone.html" class="sidebar-link">手机号输入框的格式化显示</a></li><li><a href="/Blog/blog/others/data-type.html" class="sidebar-link">数据类型与转换</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="vue-property-decorator"><a href="#vue-property-decorator" class="header-anchor">#</a> Vue Property Decorator</h1> <blockquote><p>此文的示例都来自 <a href="https://github.com/kaorun343/vue-property-decorator#vue-property-decorator" target="_blank" rel="noopener noreferrer">Vue Property Decorator<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，只是增加了一些自己的理解，作为基础学习文档</p></blockquote> <p>主要罗列一下 <code>vue</code> 装饰器的常用方法。官方文档共有以下装饰器/Mixin</p> <ul><li><code>@Prop</code></li> <li><code>@PropSync</code></li> <li><code>@Model</code></li> <li><code>@ModelSync</code></li> <li><code>@Watch</code></li> <li><code>Computed</code></li> <li><code>@Provide</code></li> <li><code>@Inject</code></li> <li><code>@ProvideReactive</code></li> <li><code>@InjectReactive</code></li> <li><code>@Emit</code></li> <li><code>@Ref</code></li> <li><code>@VModel</code></li> <li><code>@Component (provided by vue-class-component)</code></li> <li><code>Mixins (the helper function named mixins provided by vue-class-component)</code></li></ul> <p>如何使用：</p> <p><code>Vue Property Decorator</code> 主要用于 <code>vue2.x + ts</code>。创建 <code>vue</code> 项目的时候，选择 <code>class-style component syntax</code>，就会默认安装好 <code>vue-class-component</code> 和 <code>vue-property-decorator</code></p> <h2 id="prop"><a href="#prop" class="header-anchor">#</a> @Prop</h2> <p>语法：<code>@Prop(options: (PropOptions | Constructor[] | Constructor) = {})</code>，不用特意去记，跟原 <code>Props</code> 的参数基本一致，只是写法稍微变了一点</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Vue<span class="token punctuation">,</span> Component<span class="token punctuation">,</span> Prop <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue-property-decorator'</span>

@Component
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">YourComponent</span> <span class="token keyword">extends</span> <span class="token class-name">Vue</span> <span class="token punctuation">{</span>
  @<span class="token function">Prop</span><span class="token punctuation">(</span>Number<span class="token punctuation">)</span> readonly propA<span class="token operator">:</span> number <span class="token operator">|</span> <span class="token keyword">undefined</span>
  @<span class="token function">Prop</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token keyword">default</span><span class="token operator">:</span> <span class="token string">'default value'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> readonly propB<span class="token operator">!</span><span class="token operator">:</span> string
  @<span class="token function">Prop</span><span class="token punctuation">(</span><span class="token punctuation">[</span>String<span class="token punctuation">,</span> Boolean<span class="token punctuation">]</span><span class="token punctuation">)</span> readonly propC<span class="token operator">:</span> string <span class="token operator">|</span> boolean <span class="token operator">|</span> <span class="token keyword">undefined</span>
<span class="token punctuation">}</span>

<span class="token comment">// 注意不能直接用下面的方式去定义默认值</span>
@<span class="token function">Prop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> prop <span class="token operator">=</span> <span class="token string">'default value'</span> <span class="token comment">// ×</span>
</code></pre></div><p>对应的源代码为：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  props<span class="token operator">:</span> <span class="token punctuation">{</span>
    propA<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> Number
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    propB<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token keyword">default</span><span class="token operator">:</span> <span class="token string">&quot;default value&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    propC<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> <span class="token punctuation">[</span>String<span class="token punctuation">,</span> Boolean<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="propsync"><a href="#propsync" class="header-anchor">#</a> @PropSync</h2> <p>语法：<code>@PropSync(propName: string, options: (PropOptions | Constructor[] | Constructor) = {})</code>，跟 <code>vue2</code> 中的 <code>.sync</code> 修饰符实现的效果类似，但是不太建议使用这种方式，会破坏 <code>vue</code> 组件单向数据流的设定</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Vue<span class="token punctuation">,</span> Component<span class="token punctuation">,</span> PropSync <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue-property-decorator'</span>

@Component
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">YourComponent</span> <span class="token keyword">extends</span> <span class="token class-name">Vue</span> <span class="token punctuation">{</span>
  @<span class="token function">PropSync</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> String <span class="token punctuation">}</span><span class="token punctuation">)</span> syncedName<span class="token operator">!</span><span class="token operator">:</span> string
<span class="token punctuation">}</span>
</code></pre></div><p>对应的源代码为：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  props<span class="token operator">:</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> String
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  computed<span class="token operator">:</span> <span class="token punctuation">{</span>
    syncedName<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function">set</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">&quot;update:name&quot;</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>如上，在父组件传递一个 <code>name</code> 参数，在子组件，<code>@PropSync</code> 定义了一个计算属性 <code>syncedName</code>，并且设置了 <code>setter</code> 和 <code>getter</code>，在访问 <code>syncedName</code> 时，返回父组件传递过来的 <code>name</code> 值，在设置 <code>syncedName</code> 时，<code>emit</code> 一个更新事件给父组件。而在父组件，也只需要用 <code>.sync</code> 修饰符：<code>&lt;parentComponent :name.sync=&quot;name&quot;&gt;&lt;/parentComponent&gt;</code>。后续也只需要在子组件操作 <code>syncedName</code> 变量即可与父组件的变量 <code>name</code> 同步</p> <h2 id="model"><a href="#model" class="header-anchor">#</a> @Model</h2> <p>语法：<code>@Model(event?: string, options: (PropOptions | Constructor[] | Constructor) = {})</code>。先看代码</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Vue<span class="token punctuation">,</span> Component<span class="token punctuation">,</span> Model <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue-property-decorator'</span>

@Component
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">YourComponent</span> <span class="token keyword">extends</span> <span class="token class-name">Vue</span> <span class="token punctuation">{</span>
  @<span class="token function">Model</span><span class="token punctuation">(</span><span class="token string">'change'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> Boolean <span class="token punctuation">}</span><span class="token punctuation">)</span> readonly checked<span class="token operator">!</span><span class="token operator">:</span> boolean
<span class="token punctuation">}</span>

<span class="token comment">// 不要忘了同步数据时需要 $emit 一下，事件对应@Model中的事件</span>
<span class="token function">syncValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'change'</span><span class="token punctuation">,</span> someValue<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>对应的源代码为：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  model<span class="token operator">:</span> <span class="token punctuation">{</span>
    prop<span class="token operator">:</span> <span class="token string">&quot;checked&quot;</span><span class="token punctuation">,</span>
    event<span class="token operator">:</span> <span class="token string">&quot;change&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  props<span class="token operator">:</span> <span class="token punctuation">{</span>
    checked<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> Boolean
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>@Model</code> 这一项对应的是：在组件中使用 <code>v-model</code> 中的 <code>model</code> 选项</p> <p>一般情况下，<code>v-model</code> 会默认利用名为 <code>value</code> 的 <code>prop</code> 和名为 <code>input</code> 的事件（最常用）。但对于单选框、复选框这种输入控件，便不太符合场景。因此就有了 <code>model</code> 选项。具体示例可以看下上面的源代码，或更为详细的 <code>vue</code> 官方文档：<a href="https://cn.vuejs.org/v2/guide/components-custom-events.html#%E8%87%AA%E5%AE%9A%E4%B9%89%E7%BB%84%E4%BB%B6%E7%9A%84-v-model" target="_blank" rel="noopener noreferrer">自定义组件的 v-model<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>通过 <code>Model</code> 选项，我们可以自定义地修改子组件接收的 <code>prop</code>（如上源代码中的 <code>checked</code> 变量），并且修改触发的事件（如上源码中的 <code>input</code> 事件修改为 <code>change</code>），这样就可以自由控制什么时候将数据“同步”给父组件</p> <h2 id="modelsync"><a href="#modelsync" class="header-anchor">#</a> @ModelSync</h2> <p>语法：<code>@ModelSync(propName: string, event?: string, options: (PropOptions | Constructor[] | Constructor) = {})</code>，与 <code>@Model</code> 想比较之下，<code>@ModelSync</code> 会自动 <code>$emit</code> 对应事件给父组件，使用起来应该会更舒服一些。不过说实话，基本没咋用过 <code>model</code> 选项 em...</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Vue<span class="token punctuation">,</span> Component<span class="token punctuation">,</span> ModelSync <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue-property-decorator'</span>

@Component
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">YourComponent</span> <span class="token keyword">extends</span> <span class="token class-name">Vue</span> <span class="token punctuation">{</span>
  @<span class="token function">ModelSync</span><span class="token punctuation">(</span><span class="token string">'checked'</span><span class="token punctuation">,</span> <span class="token string">'change'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> Boolean <span class="token punctuation">}</span><span class="token punctuation">)</span>
  readonly checkedValue<span class="token operator">!</span><span class="token operator">:</span> boolean
<span class="token punctuation">}</span>

<span class="token comment">// 现在修改 checkedValue 会自动 $emit 给父组件</span>
</code></pre></div><p>对应的源代码为：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  model<span class="token operator">:</span> <span class="token punctuation">{</span>
    prop<span class="token operator">:</span> <span class="token string">&quot;checked&quot;</span><span class="token punctuation">,</span>
    event<span class="token operator">:</span> <span class="token string">&quot;change&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  props<span class="token operator">:</span> <span class="token punctuation">{</span>
    checked<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> Boolean
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  computed<span class="token operator">:</span> <span class="token punctuation">{</span>
    checkedValue<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>checked
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function">set</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">&quot;change&quot;</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="watch"><a href="#watch" class="header-anchor">#</a> @Watch</h2> <p>语法：<code>@Watch(path: string, options: WatchOptions = {})</code>，也就是监听器 <code>watch</code>，基本都一样了，稍微熟悉一下即可</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Vue<span class="token punctuation">,</span> Component<span class="token punctuation">,</span> Watch <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue-property-decorator&quot;</span>

@Component
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">YourComponent</span> <span class="token keyword">extends</span> <span class="token class-name">Vue</span> <span class="token punctuation">{</span>
  @<span class="token function">Watch</span><span class="token punctuation">(</span><span class="token string">&quot;child&quot;</span><span class="token punctuation">)</span> <span class="token comment">//修饰符</span>
  <span class="token function">onChildChanged</span><span class="token punctuation">(</span><span class="token parameter">val<span class="token operator">:</span> string<span class="token punctuation">,</span> oldVal<span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">//对应方法</span>

  @<span class="token function">Watch</span><span class="token punctuation">(</span><span class="token string">&quot;person&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> immediate<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> deep<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token function">onPersonChanged1</span><span class="token punctuation">(</span><span class="token parameter">val<span class="token operator">:</span> Person<span class="token punctuation">,</span> oldVal<span class="token operator">:</span> Person</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  @<span class="token function">Watch</span><span class="token punctuation">(</span><span class="token string">&quot;person&quot;</span><span class="token punctuation">)</span>
  <span class="token function">onPersonChanged2</span><span class="token punctuation">(</span><span class="token parameter">val<span class="token operator">:</span> Person<span class="token punctuation">,</span> oldVal<span class="token operator">:</span> Person</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  @<span class="token function">Watch</span><span class="token punctuation">(</span><span class="token string">&quot;person&quot;</span><span class="token punctuation">)</span>
  @<span class="token function">Watch</span><span class="token punctuation">(</span><span class="token string">&quot;child&quot;</span><span class="token punctuation">)</span>
  <span class="token function">onPersonAndChildChanged</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>对应的源代码为：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  watch<span class="token operator">:</span> <span class="token punctuation">{</span>
    child<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        handler<span class="token operator">:</span> <span class="token string">&quot;onChildChanged&quot;</span><span class="token punctuation">,</span>
        immediate<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        deep<span class="token operator">:</span> <span class="token boolean">false</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        handler<span class="token operator">:</span> <span class="token string">&quot;onPersonAndChildChanged&quot;</span><span class="token punctuation">,</span>
        immediate<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        deep<span class="token operator">:</span> <span class="token boolean">false</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    person<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        handler<span class="token operator">:</span> <span class="token string">&quot;onPersonChanged1&quot;</span><span class="token punctuation">,</span>
        immediate<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        deep<span class="token operator">:</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        handler<span class="token operator">:</span> <span class="token string">&quot;onPersonChanged2&quot;</span><span class="token punctuation">,</span>
        immediate<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        deep<span class="token operator">:</span> <span class="token boolean">false</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        handler<span class="token operator">:</span> <span class="token string">&quot;onPersonAndChildChanged&quot;</span><span class="token punctuation">,</span>
        immediate<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        deep<span class="token operator">:</span> <span class="token boolean">false</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">onChildChanged</span><span class="token punctuation">(</span><span class="token parameter">val<span class="token punctuation">,</span> oldVal</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">onPersonChanged1</span><span class="token punctuation">(</span><span class="token parameter">val<span class="token punctuation">,</span> oldVal</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">onPersonChanged2</span><span class="token punctuation">(</span><span class="token parameter">val<span class="token punctuation">,</span> oldVal</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">onPersonAndChildChanged</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="computed"><a href="#computed" class="header-anchor">#</a> Computed</h2> <p><code>computed</code> 选项已经被替代为 <code>getter</code>、<code>setter</code></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span>
<span class="token keyword">import</span> Component <span class="token keyword">from</span> <span class="token string">&quot;vue-class-component&quot;</span>

@Component
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">HelloWorld</span> <span class="token keyword">extends</span> <span class="token class-name">Vue</span> <span class="token punctuation">{</span>
  firstName <span class="token operator">=</span> <span class="token string">&quot;John&quot;</span>
  lastName <span class="token operator">=</span> <span class="token string">&quot;Doe&quot;</span>

  <span class="token comment">// Declared as computed property getter</span>
  <span class="token keyword">get</span> <span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>firstName <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>lastName
  <span class="token punctuation">}</span>

  <span class="token comment">// Declared as computed property setter</span>
  <span class="token keyword">set</span> <span class="token function">name</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> splitted <span class="token operator">=</span> value<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot; &quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>firstName <span class="token operator">=</span> splitted<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>lastName <span class="token operator">=</span> splitted<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token string">&quot;&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="provide、-inject"><a href="#provide、-inject" class="header-anchor">#</a> @Provide、@Inject</h2> <p>语法：<code>@Provide(key?: string | symbol) / @Inject(options?: { from?: InjectKey, default?: any } | InjectKey)</code>，先看代码</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Component<span class="token punctuation">,</span> Inject<span class="token punctuation">,</span> Provide<span class="token punctuation">,</span> Vue <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue-property-decorator'</span>

<span class="token keyword">const</span> symbol <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'baz'</span><span class="token punctuation">)</span>

@Component
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">MyComponent</span> <span class="token keyword">extends</span> <span class="token class-name">Vue</span> <span class="token punctuation">{</span>
  @<span class="token function">Inject</span><span class="token punctuation">(</span><span class="token punctuation">)</span> readonly foo<span class="token operator">!</span><span class="token operator">:</span> string
  @<span class="token function">Inject</span><span class="token punctuation">(</span><span class="token string">'bar'</span><span class="token punctuation">)</span> readonly bar<span class="token operator">!</span><span class="token operator">:</span> string
  @<span class="token function">Inject</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token keyword">from</span><span class="token operator">:</span> <span class="token string">'optional'</span><span class="token punctuation">,</span> <span class="token keyword">default</span><span class="token operator">:</span> <span class="token string">'default'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> readonly optional<span class="token operator">!</span><span class="token operator">:</span> string
  @<span class="token function">Inject</span><span class="token punctuation">(</span>symbol<span class="token punctuation">)</span> readonly baz<span class="token operator">!</span><span class="token operator">:</span> string

  @<span class="token function">Provide</span><span class="token punctuation">(</span><span class="token punctuation">)</span> foo <span class="token operator">=</span> <span class="token string">'foo'</span>
  @<span class="token function">Provide</span><span class="token punctuation">(</span><span class="token string">'bar'</span><span class="token punctuation">)</span> baz <span class="token operator">=</span> <span class="token string">'bar'</span>
<span class="token punctuation">}</span>
</code></pre></div><p>对应的源代码为：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> symbol <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">&quot;baz&quot;</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> MyComponent <span class="token operator">=</span> Vue<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  inject<span class="token operator">:</span> <span class="token punctuation">{</span>
    foo<span class="token operator">:</span> <span class="token string">&quot;foo&quot;</span><span class="token punctuation">,</span>
    bar<span class="token operator">:</span> <span class="token string">&quot;bar&quot;</span><span class="token punctuation">,</span>
    optional<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token keyword">from</span><span class="token operator">:</span> <span class="token string">&quot;optional&quot;</span><span class="token punctuation">,</span> <span class="token keyword">default</span><span class="token operator">:</span> <span class="token string">&quot;default&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    baz<span class="token operator">:</span> symbol
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      foo<span class="token operator">:</span> <span class="token string">&quot;foo&quot;</span><span class="token punctuation">,</span>
      baz<span class="token operator">:</span> <span class="token string">&quot;bar&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">provide</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      foo<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>foo<span class="token punctuation">,</span>
      bar<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>baz
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>在 <code>vue2.x</code> 中，于本人来说 <code>Provide/Inject</code> 用的是相对比较少的，一方面不会使用层级过深的组件，另一方面 <code>Provide/Inject</code> 也具有其一定的缺陷：<a href="https://cn.vuejs.org/v2/guide/components-edge-cases.html#%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5" target="_blank" rel="noopener noreferrer">依赖注入<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>；在 <code>vue3.x</code> 中，可以用来全局注入，如 <code>vue2.x</code> 中的 <code>Vue.prototype</code>（<code>vue3.x</code> 中已被废除，<code>Provide/Inject</code> 作为替代方案：<a href="https://v3.cn.vuejs.org/guide/migration/global-api.html#vue-prototype-%E6%9B%BF%E6%8D%A2%E4%B8%BA-config-globalproperties" target="_blank" rel="noopener noreferrer">查看文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>）</p> <h2 id="emit"><a href="#emit" class="header-anchor">#</a> @Emit</h2> <p>语法：<code>@Emit(event?: string)</code>，直接看代码，熟悉熟悉就可以上手的了</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Vue<span class="token punctuation">,</span> Component<span class="token punctuation">,</span> Emit <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue-property-decorator&quot;</span>

@Component
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">YourComponent</span> <span class="token keyword">extends</span> <span class="token class-name">Vue</span> <span class="token punctuation">{</span>
  count <span class="token operator">=</span> <span class="token number">0</span>

  @<span class="token function">Emit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">addToCount</span><span class="token punctuation">(</span><span class="token parameter">n<span class="token operator">:</span> number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>count <span class="token operator">+=</span> n
  <span class="token punctuation">}</span>

  @<span class="token function">Emit</span><span class="token punctuation">(</span><span class="token string">&quot;reset&quot;</span><span class="token punctuation">)</span>
  <span class="token function">resetCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>count <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token punctuation">}</span>

  @<span class="token function">Emit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">returnValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">10</span>
  <span class="token punctuation">}</span>

  @<span class="token function">Emit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">onInputChange</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value
  <span class="token punctuation">}</span>

  @<span class="token function">Emit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">promise</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>对应的源代码为：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      count<span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">addToCount</span><span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>count <span class="token operator">+=</span> n
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">&quot;add-to-count&quot;</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">resetCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>count <span class="token operator">=</span> <span class="token number">0</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">&quot;reset&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">returnValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">&quot;return-value&quot;</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">onInputChange</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">&quot;on-input-change&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">,</span> e<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">promise</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> promise <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>

      promise<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">&quot;promise&quot;</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="vuex-class"><a href="#vuex-class" class="header-anchor">#</a> Vuex-Class</h2> <p><code>vuex</code> 也有对应的装饰器，用起来比较舒服，不用写那么长的代码了：<code>this.$store.state.user.userInfo</code>...</p> <p>官网地址：<a href="https://github.com/ktsn/vuex-class/" target="_blank" rel="noopener noreferrer">vuex-class<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span>
<span class="token keyword">import</span> Component <span class="token keyword">from</span> <span class="token string">&quot;vue-class-component&quot;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> State<span class="token punctuation">,</span> Getter<span class="token punctuation">,</span> Action<span class="token punctuation">,</span> Mutation<span class="token punctuation">,</span> namespace <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vuex-class&quot;</span>

<span class="token keyword">const</span> someModule <span class="token operator">=</span> <span class="token function">namespace</span><span class="token punctuation">(</span><span class="token string">&quot;path/to/module&quot;</span><span class="token punctuation">)</span>

@Component
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">MyComp</span> <span class="token keyword">extends</span> <span class="token class-name">Vue</span> <span class="token punctuation">{</span>
  @<span class="token function">State</span><span class="token punctuation">(</span><span class="token string">&quot;foo&quot;</span><span class="token punctuation">)</span> stateFoo
  @<span class="token function">State</span><span class="token punctuation">(</span><span class="token parameter">state</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>bar<span class="token punctuation">)</span> stateBar
  @<span class="token function">Getter</span><span class="token punctuation">(</span><span class="token string">&quot;foo&quot;</span><span class="token punctuation">)</span> getterFoo
  @<span class="token function">Action</span><span class="token punctuation">(</span><span class="token string">&quot;foo&quot;</span><span class="token punctuation">)</span> actionFoo
  @<span class="token function">Mutation</span><span class="token punctuation">(</span><span class="token string">&quot;foo&quot;</span><span class="token punctuation">)</span> mutationFoo
  @someModule<span class="token punctuation">.</span><span class="token function">Getter</span><span class="token punctuation">(</span><span class="token string">&quot;foo&quot;</span><span class="token punctuation">)</span> moduleGetterFoo

  <span class="token comment">// If the argument is omitted, use the property name</span>
  <span class="token comment">// for each state/getter/action/mutation type</span>
  @State foo
  @Getter bar
  @Action baz
  @Mutation qux

  <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>stateFoo <span class="token comment">// -&gt; store.state.foo</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>stateBar <span class="token comment">// -&gt; store.state.bar</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>getterFoo <span class="token comment">// -&gt; store.getters.foo</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">actionFoo</span><span class="token punctuation">(</span><span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// -&gt; store.dispatch('foo', { value: true })</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">mutationFoo</span><span class="token punctuation">(</span><span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// -&gt; store.commit('foo', { value: true })</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>moduleGetterFoo <span class="token comment">// -&gt; store.getters['path/to/module/foo']</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><hr> <h2 id="vuex-module-decorators-起步"><a href="#vuex-module-decorators-起步" class="header-anchor">#</a> vuex-module-decorators 起步</h2> <p>新增 <code>vuex-module-decorators</code>，文档及示例地址为：<a href="https://championswimmer.in/vuex-module-decorators/" target="_blank" rel="noopener noreferrer">'vuex-module-decorators<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ul><li><code>State</code></li> <li><code>@Mutation</code></li> <li><code>Getter</code></li> <li><code>@Action</code></li> <li><code>@MutationAction</code></li> <li><code>Dynamic Module</code></li></ul> <h2 id="state"><a href="#state" class="header-anchor">#</a> State</h2> <p><code>vuex-module-decorators</code> 取消了 <code>State</code> 选项，跟 <code>vue3</code> 一样，直接定义写变量即可。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Module<span class="token punctuation">,</span> VuexModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vuex-module-decorators&quot;</span>

@Module
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Vehicle</span> <span class="token keyword">extends</span> <span class="token class-name">VuexModule</span> <span class="token punctuation">{</span>
  wheels <span class="token operator">=</span> <span class="token number">2</span>
<span class="token punctuation">}</span>
</code></pre></div><p>对应的源代码为：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  state<span class="token operator">:</span> <span class="token punctuation">{</span>
    wheels<span class="token operator">:</span> <span class="token number">2</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="mutation"><a href="#mutation" class="header-anchor">#</a> @Mutation</h2> <p>当使用 <code>Mutation</code> 装饰器时，使用 <code>this</code> 修改 <code>State</code> 数据。同时，在 <code>Mutation</code> 中避免使用<strong>异步函数</strong>以及<strong>箭头函数</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Module<span class="token punctuation">,</span> VuexModule<span class="token punctuation">,</span> Mutation <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vuex-module-decorators&quot;</span>

@Module
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Vehicle</span> <span class="token keyword">extends</span> <span class="token class-name">VuexModule</span> <span class="token punctuation">{</span>
  wheels <span class="token operator">=</span> <span class="token number">2</span>

  @Mutation
  <span class="token function">puncture</span><span class="token punctuation">(</span><span class="token parameter">n<span class="token operator">:</span> number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>wheels <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>wheels <span class="token operator">-</span> n
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>对应的源代码为：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  state<span class="token operator">:</span> <span class="token punctuation">{</span>
    wheels<span class="token operator">:</span> <span class="token number">2</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  mutations<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">puncture</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> payload</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      state<span class="token punctuation">.</span>wheels <span class="token operator">=</span> state<span class="token punctuation">.</span>wheels <span class="token operator">-</span> payload
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="getter"><a href="#getter" class="header-anchor">#</a> Getter</h2> <p>此时的 <code>Getter</code> 不再是 <code>store</code> 的一个选项，而是成为了 <code>es6</code> 的 <code>getter</code> 函数</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Module<span class="token punctuation">,</span> VuexModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vuex-module-decorators&quot;</span>

@Module
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Vehicle</span> <span class="token keyword">extends</span> <span class="token class-name">VuexModule</span> <span class="token punctuation">{</span>
  wheels <span class="token operator">=</span> <span class="token number">2</span>
  <span class="token keyword">get</span> <span class="token function">axles</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>wheels <span class="token operator">/</span> <span class="token number">2</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>对应的源代码为：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  state<span class="token operator">:</span> <span class="token punctuation">{</span>
    wheels<span class="token operator">:</span> <span class="token number">2</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  getters<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">axles</span><span class="token operator">:</span> <span class="token parameter">state</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>wheels <span class="token operator">/</span> <span class="token number">2</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="action"><a href="#action" class="header-anchor">#</a> @Action</h2> <p>如果需要在 <code>Action</code> 执行长时间运行的任务，建议将其定义为异步函数（<code>async-await</code>）。如果不这么做的话，<code>vuex-module-decorators</code> 也会将你的函数包装成一个 <code>Promise</code> 函数并等待它；同时也不要将其定义为箭头函数，因为需要重新绑定 <code>Actions</code></p> <p>这里稍微注意一下，在 <code>Action</code> 中需要修改 <code>state</code> 的话，还是需要通过提交 <code>Mutation</code>。而现在需要使用 <code>this.context.commit()</code> 提交</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Module<span class="token punctuation">,</span> VuexModule<span class="token punctuation">,</span> Mutation<span class="token punctuation">,</span> Action <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vuex-module-decorators&quot;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> get <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;request&quot;</span>

@Module
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Vehicle</span> <span class="token keyword">extends</span> <span class="token class-name">VuexModule</span> <span class="token punctuation">{</span>
  wheels <span class="token operator">=</span> <span class="token number">2</span>

  @Mutation
  <span class="token function">addWheel</span><span class="token punctuation">(</span><span class="token parameter">n<span class="token operator">:</span> number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>wheels <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>wheels <span class="token operator">+</span> n
  <span class="token punctuation">}</span>

  @Action
  <span class="token keyword">async</span> <span class="token function">fetchNewWheels</span><span class="token punctuation">(</span><span class="token parameter">wheelStore<span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> wheels <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">get</span><span class="token punctuation">(</span>wheelStore<span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;addWheel&quot;</span><span class="token punctuation">,</span> wheels<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>对应的源代码为：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> request <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;request&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  state<span class="token operator">:</span> <span class="token punctuation">{</span>
    wheels<span class="token operator">:</span> <span class="token number">2</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  mutations<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">addWheel</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> payload</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      state<span class="token punctuation">.</span>wheels <span class="token operator">=</span> state<span class="token punctuation">.</span>wheels <span class="token operator">+</span> payload
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  actions<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">fetchNewWheels</span><span class="token operator">:</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> payload</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> wheels <span class="token operator">=</span> <span class="token keyword">await</span> request<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span>
      context<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;addWheel&quot;</span><span class="token punctuation">,</span> wheels<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="mutationactions"><a href="#mutationactions" class="header-anchor">#</a> @MutationActions</h2> <p>如果当前有一个异步操作，并且获得的结果需要提交到 <code>state</code>，那么可以使用 <code>@MutationActions</code>。需要注意，当其返回的是 <code>undefined</code> 时，不会提交到 <code>state</code></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>VuexModule<span class="token punctuation">,</span> Module<span class="token punctuation">,</span> MutationAction<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vuex-module-decorators'</span>

@Module
<span class="token keyword">class</span> <span class="token class-name">TypicodeModule</span> <span class="token keyword">extends</span> <span class="token class-name">VuexModule</span> <span class="token punctuation">{</span>
  posts<span class="token operator">:</span> Post<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  users<span class="token operator">:</span> User<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

  @MutationAction
  <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">updatePosts</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> posts <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'https://jsonplaceholder.typicode.com/posts'</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span> posts <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>对应的源代码为：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> typicodeModule <span class="token operator">=</span> <span class="token punctuation">{</span>
  state<span class="token operator">:</span> <span class="token punctuation">{</span>
    posts<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    users<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  mutations<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">updatePosts</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> posts</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      state<span class="token punctuation">.</span>posts <span class="token operator">=</span> posts
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  actions<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">updatePosts</span><span class="token operator">:</span> <span class="token keyword">async</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> posts <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;https://jsonplaceholder.typicode.com/posts&quot;</span><span class="token punctuation">)</span>
      context<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;updatePosts&quot;</span><span class="token punctuation">,</span> posts<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="dynamic-module"><a href="#dynamic-module" class="header-anchor">#</a> Dynamic Module</h2> <p>使用 <code>vuex-module-decorators</code> 之后，可以使用动态 <code>Modules</code>。动态 <code>Modules</code>在注册时，跟一般的 <code>vuex</code> 不一样，在 <code>@store/index.ts</code> 中，只需要 <code>new</code> 一个空的 <code>Vuex.Store({})</code></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// Dynamic Modules</span>
<span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span>
<span class="token keyword">import</span> Vuex <span class="token keyword">from</span> <span class="token string">&quot;vuex&quot;</span>

Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Vuex<span class="token punctuation">)</span>
<span class="token comment">// Declare empty store first, dynamically register all modules later.</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>在具体的 <code>module</code> 下，需要注意：</p> <ul><li>指定 <code>module</code> 为动态 <code>module</code></li> <li>必须要指定 <code>name</code></li> <li>需要通过 <code>getModule</code> 将模块 <code>export</code> 出去</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Module<span class="token punctuation">,</span> VuexModule<span class="token punctuation">,</span> getModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vuex-module-decorators&quot;</span>
<span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">&quot;@/store&quot;</span>

@<span class="token function">Module</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  namespaced<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  dynamic<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  store<span class="token punctuation">,</span>
  name<span class="token operator">:</span> <span class="token string">&quot;User&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token keyword">extends</span> <span class="token class-name">VuexModule</span> <span class="token punctuation">{</span>
  userInfo <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">&quot;wolfBerry&quot;</span><span class="token punctuation">,</span>
    phone<span class="token operator">:</span> <span class="token string">&quot;18819490370&quot;</span><span class="token punctuation">,</span>
    email<span class="token operator">:</span> <span class="token string">&quot;906368017@qq.com&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> UserModule <span class="token operator">=</span> <span class="token function">getModule</span><span class="token punctuation">(</span>User<span class="token punctuation">)</span>
</code></pre></div><p>最后就可以在页面上，通过 <code>import</code> 引入后再使用</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> UserModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@/store/module/user&quot;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> TestModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@/store/module/test&quot;</span>

@Component
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Home</span> <span class="token keyword">extends</span> <span class="token class-name">Vue</span> <span class="token punctuation">{</span>
  <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>UserModule<span class="token punctuation">.</span>userInfo<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">handleChange</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    TestModule<span class="token punctuation">.</span><span class="token constant">SET_COUNT</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="结尾"><a href="#结尾" class="header-anchor">#</a> 结尾</h2> <p>目前 <code>vuex-module-decorator</code> 不支持动态模块和嵌套模块混合使用，只能使用其中一种</p> <p><code>vuex-module-decorator</code>、<code>vuex-class</code>、<code>vue-class-component</code> 三者熟练使用起来可以省掉很多代码，真的是谁用谁舒服，并且可以让代码看起来更 “<strong>高级</strong>” 一些哈！！！</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/Real102/Blog/edit/master/docs/blog/vue/decorator.md" target="_blank" rel="noopener noreferrer">Edit in GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">3/1/2022, 4:29:32 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/Blog/blog/vue/vue-env.html" class="prev">
        vue 环境变量的设置与使用
      </a></span> <span class="next"><a href="/Blog/blog/vue/wechat-auth.html">
        微信 JS-SDK 实现自定义分享功能
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/Blog/assets/js/app.26c94a5c.js" defer></script><script src="/Blog/assets/js/2.b2fff99d.js" defer></script><script src="/Blog/assets/js/46.7f053f0a.js" defer></script>
  </body>
</html>
