<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>【字体压缩】淦，以后不用怕字体文件了 | WolfBerry</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="WolfBerry's Blog">
    
    <link rel="preload" href="/Blog/assets/css/0.styles.582bb75b.css" as="style"><link rel="preload" href="/Blog/assets/js/app.26c94a5c.js" as="script"><link rel="preload" href="/Blog/assets/js/2.b2fff99d.js" as="script"><link rel="preload" href="/Blog/assets/js/5.b9636d6c.js" as="script"><link rel="prefetch" href="/Blog/assets/js/10.07ed30bc.js"><link rel="prefetch" href="/Blog/assets/js/11.4405ba45.js"><link rel="prefetch" href="/Blog/assets/js/12.21f3d656.js"><link rel="prefetch" href="/Blog/assets/js/13.6282d122.js"><link rel="prefetch" href="/Blog/assets/js/14.6d0c4961.js"><link rel="prefetch" href="/Blog/assets/js/15.4904075b.js"><link rel="prefetch" href="/Blog/assets/js/16.3318e70c.js"><link rel="prefetch" href="/Blog/assets/js/17.126dec48.js"><link rel="prefetch" href="/Blog/assets/js/18.f3baeba3.js"><link rel="prefetch" href="/Blog/assets/js/19.d9a0b707.js"><link rel="prefetch" href="/Blog/assets/js/20.4b9c544c.js"><link rel="prefetch" href="/Blog/assets/js/21.82d0e7f1.js"><link rel="prefetch" href="/Blog/assets/js/22.42b8ae09.js"><link rel="prefetch" href="/Blog/assets/js/23.c676b601.js"><link rel="prefetch" href="/Blog/assets/js/24.6e1c47f1.js"><link rel="prefetch" href="/Blog/assets/js/25.310dad1a.js"><link rel="prefetch" href="/Blog/assets/js/26.a7745fbc.js"><link rel="prefetch" href="/Blog/assets/js/27.e451bb4b.js"><link rel="prefetch" href="/Blog/assets/js/28.51707047.js"><link rel="prefetch" href="/Blog/assets/js/29.edfaf11e.js"><link rel="prefetch" href="/Blog/assets/js/3.60a6da4e.js"><link rel="prefetch" href="/Blog/assets/js/30.e25e4396.js"><link rel="prefetch" href="/Blog/assets/js/31.c06c845b.js"><link rel="prefetch" href="/Blog/assets/js/32.cdc8bf6c.js"><link rel="prefetch" href="/Blog/assets/js/33.3de22c63.js"><link rel="prefetch" href="/Blog/assets/js/34.b56e280b.js"><link rel="prefetch" href="/Blog/assets/js/35.4d6ccb74.js"><link rel="prefetch" href="/Blog/assets/js/36.a729c293.js"><link rel="prefetch" href="/Blog/assets/js/37.48a8f1df.js"><link rel="prefetch" href="/Blog/assets/js/38.69b10e03.js"><link rel="prefetch" href="/Blog/assets/js/39.62484b18.js"><link rel="prefetch" href="/Blog/assets/js/4.8dfc73e1.js"><link rel="prefetch" href="/Blog/assets/js/40.7b5c5c55.js"><link rel="prefetch" href="/Blog/assets/js/41.73c45021.js"><link rel="prefetch" href="/Blog/assets/js/42.9f3fc2e2.js"><link rel="prefetch" href="/Blog/assets/js/43.a4bee912.js"><link rel="prefetch" href="/Blog/assets/js/44.acb8c2a6.js"><link rel="prefetch" href="/Blog/assets/js/45.d02eb0a9.js"><link rel="prefetch" href="/Blog/assets/js/46.7f053f0a.js"><link rel="prefetch" href="/Blog/assets/js/47.46c8786e.js"><link rel="prefetch" href="/Blog/assets/js/48.19b67883.js"><link rel="prefetch" href="/Blog/assets/js/49.ce6aa35d.js"><link rel="prefetch" href="/Blog/assets/js/50.2497754c.js"><link rel="prefetch" href="/Blog/assets/js/51.e1c78dcc.js"><link rel="prefetch" href="/Blog/assets/js/52.89262c74.js"><link rel="prefetch" href="/Blog/assets/js/53.47860fb3.js"><link rel="prefetch" href="/Blog/assets/js/54.4d1f45ac.js"><link rel="prefetch" href="/Blog/assets/js/55.b2dac113.js"><link rel="prefetch" href="/Blog/assets/js/56.34c7045e.js"><link rel="prefetch" href="/Blog/assets/js/57.d614f134.js"><link rel="prefetch" href="/Blog/assets/js/58.e88fc109.js"><link rel="prefetch" href="/Blog/assets/js/59.d386972e.js"><link rel="prefetch" href="/Blog/assets/js/6.e72b2b73.js"><link rel="prefetch" href="/Blog/assets/js/60.a3d054ef.js"><link rel="prefetch" href="/Blog/assets/js/61.27b0d020.js"><link rel="prefetch" href="/Blog/assets/js/62.742bc712.js"><link rel="prefetch" href="/Blog/assets/js/63.0cf87451.js"><link rel="prefetch" href="/Blog/assets/js/64.ee8cefe2.js"><link rel="prefetch" href="/Blog/assets/js/65.2a3e00d6.js"><link rel="prefetch" href="/Blog/assets/js/66.c16d7376.js"><link rel="prefetch" href="/Blog/assets/js/67.22d5664d.js"><link rel="prefetch" href="/Blog/assets/js/68.3163821e.js"><link rel="prefetch" href="/Blog/assets/js/69.ba149287.js"><link rel="prefetch" href="/Blog/assets/js/7.8d9b6daa.js"><link rel="prefetch" href="/Blog/assets/js/70.79b3941c.js"><link rel="prefetch" href="/Blog/assets/js/71.9633a5fc.js"><link rel="prefetch" href="/Blog/assets/js/72.0a582a8b.js"><link rel="prefetch" href="/Blog/assets/js/8.f72dab87.js"><link rel="prefetch" href="/Blog/assets/js/9.db5433a8.js">
    <link rel="stylesheet" href="/Blog/assets/css/0.styles.582bb75b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Blog/" class="home-link router-link-active"><!----> <span class="site-name">WolfBerry</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Blog/blog/" class="nav-link router-link-active">
  Blog
</a></div><div class="nav-item"><a href="/Blog/ugly/" class="nav-link">
  Ugly
</a></div><div class="nav-item"><a href="/Blog/gold/" class="nav-link">
  Gold
</a></div><div class="nav-item"><a href="/Blog/diary/" class="nav-link">
  Diary
</a></div> <a href="https://github.com/Real102/Blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Blog/blog/" class="nav-link router-link-active">
  Blog
</a></div><div class="nav-item"><a href="/Blog/ugly/" class="nav-link">
  Ugly
</a></div><div class="nav-item"><a href="/Blog/gold/" class="nav-link">
  Gold
</a></div><div class="nav-item"><a href="/Blog/diary/" class="nav-link">
  Diary
</a></div> <a href="https://github.com/Real102/Blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>博客</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Blog/blog/" aria-current="page" class="sidebar-link">介绍</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>HTML</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Blog/blog/html/meta.html" class="sidebar-link">常用的meta标签</a></li><li><a href="/Blog/blog/html/unicode.html" class="sidebar-link">字符编码</a></li><li><a href="/Blog/blog/html/font.html" aria-current="page" class="active sidebar-link">【字体压缩】淦，以后不用怕字体文件了</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Blog/blog/html/font.html#背景" class="sidebar-link">背景</a></li><li class="sidebar-sub-header"><a href="/Blog/blog/html/font.html#fontmin" class="sidebar-link">Fontmin</a></li><li class="sidebar-sub-header"><a href="/Blog/blog/html/font.html#预备工作" class="sidebar-link">预备工作</a></li><li class="sidebar-sub-header"><a href="/Blog/blog/html/font.html#开撸" class="sidebar-link">开撸</a></li><li class="sidebar-sub-header"><a href="/Blog/blog/html/font.html#优化" class="sidebar-link">优化</a></li><li class="sidebar-sub-header"><a href="/Blog/blog/html/font.html#完整代码" class="sidebar-link">完整代码</a></li><li class="sidebar-sub-header"><a href="/Blog/blog/html/font.html#思考" class="sidebar-link">思考</a></li></ul></li><li><a href="/Blog/blog/html/vh.html" class="sidebar-link">vh 高度问题</a></li><li><a href="/Blog/blog/html/scss.html" class="sidebar-link">scss 常见用法</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Javascript</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Blog/blog/javascript/get-image-size.html" class="sidebar-link">限制上传图片的尺寸</a></li><li><a href="/Blog/blog/javascript/preload-image.html" class="sidebar-link">图片预加载</a></li><li><a href="/Blog/blog/javascript/lazyload.html" class="sidebar-link">图片懒加载的两种实现方式</a></li><li><a href="/Blog/blog/javascript/encryption.html" class="sidebar-link">常用的加密方案及相关实现代码</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Typescript</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Blog/blog/typescript/practice.html" class="sidebar-link">TS练习题</a></li><li><a href="/Blog/blog/typescript/extends.html" class="sidebar-link">TS 中的 extends 关键字</a></li><li><a href="/Blog/blog/typescript/built-in.html" class="sidebar-link">TS 常用内置类型</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Vue</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Blog/blog/vue/img-in-vue.html" class="sidebar-link">在vue项目中引入图片</a></li><li><a href="/Blog/blog/vue/vue-env.html" class="sidebar-link">vue 环境变量的设置与使用</a></li><li><a href="/Blog/blog/vue/decorator.html" class="sidebar-link">Vue Property Decorator</a></li><li><a href="/Blog/blog/vue/wechat-auth.html" class="sidebar-link">微信 JS-SDK 实现自定义分享功能</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Webpack</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Blog/blog/webpack/require-context.html" class="sidebar-link">require.context 的妙用</a></li><li><a href="/Blog/blog/webpack/lodash.html" class="sidebar-link">lodash 按需引入及打包优化</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>工具/插件</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Blog/blog/plugin/rrweb.html" class="sidebar-link">rrweb -- 录制并回放web界面用户操作</a></li><li><a href="/Blog/blog/plugin/puppeteer.html" class="sidebar-link">Puppeteer</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>移动端</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Blog/blog/mobile/preview-on-mobile.html" class="sidebar-link">手机端预览vue项目</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>其他</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Blog/blog/others/onlineTime.html" class="sidebar-link">用户在线时长统计方案思考</a></li><li><a href="/Blog/blog/others/test-unit.html" class="sidebar-link">单元测试</a></li><li><a href="/Blog/blog/others/quickapp.html" class="sidebar-link">快应用的填坑日志</a></li><li><a href="/Blog/blog/others/miniApp.html" class="sidebar-link">小程序探究</a></li><li><a href="/Blog/blog/others/nvm.html" class="sidebar-link">使用 nvm 来管理 npm</a></li><li><a href="/Blog/blog/others/vscode-for-web.html" class="sidebar-link">搭建 web 版 vs code</a></li><li><a href="/Blog/blog/others/ws-in-vscode.html" class="sidebar-link">研究vscode中的websocket</a></li><li><a href="/Blog/blog/others/format-phone.html" class="sidebar-link">手机号输入框的格式化显示</a></li><li><a href="/Blog/blog/others/data-type.html" class="sidebar-link">数据类型与转换</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="【字体压缩】淦-以后不用怕字体文件了"><a href="#【字体压缩】淦-以后不用怕字体文件了" class="header-anchor">#</a> 【字体压缩】淦，以后不用怕字体文件了</h1> <h2 id="背景"><a href="#背景" class="header-anchor">#</a> 背景</h2> <p>开发项目的时候遇到一个这样的需求：要求使用思源黑体。据了解，一般字体文件体积都是蛮大的，通常 <code>5MB+</code>。谷歌了下思源黑体字体包，更是达到了 <code>10MB</code>。这么大的字体包肯定不可能直接用到项目中去，用了就是跟 🐢 比速度</p> <p>回归正传，直接用字体包肯定是不行的，那能不能跟图片一样可以去 <strong>“压缩”</strong> 一下呢？🤔</p> <h2 id="fontmin"><a href="#fontmin" class="header-anchor">#</a> Fontmin</h2> <p><code>Fontmin</code> 是一个纯 <code>JS</code> 字体子集化方案。利用 <code>Fontmin</code> 可以提取 <code>TTF</code> 字体文件中需要用到的字符，然后转换为 <code>TTF</code> 文件输出，从而实现“压缩”的效果</p> <p>官网地址：<a href="http://ecomfe.github.io/fontmin/" target="_blank" rel="noopener noreferrer">http://ecomfe.github.io/fontmin/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>这是目前找到的一个比较好的解决方案，接下来就开始撸一下代码测试测试吧。</p> <h2 id="预备工作"><a href="#预备工作" class="header-anchor">#</a> 预备工作</h2> <p>先准备一个代码仓库（<code>vue</code> 项目、新文件夹 <code>npm init</code> 一下都 OK，能用就行。以下是基于 <code>vue</code> 项目写的测试代码）</p> <p>安装 <code>fontmin</code> 插件</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">npm</span> <span class="token function">install</span> --save fontmin
</code></pre></div><p>准备一个字体包，这里为了显示效果明显一点，选用了华文仿宋字体，不大，也就 <code>11MB</code>🤢</p> <p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAm8AAAAeCAYAAAB61/nFAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAp2SURBVHhe7Z3Lbhw3Fob7deYVej/IS8wmG81KTxAg294qy9kEvRgg2QwQGOO229Yggxk4kS+y3bEda0azMRDHkmxZvsg3QQKH5/BShyySVd3qbrmk/wMIdxXJc06xyMO/q1pJTwEAAAAAgM4A8QYAAAAA0CEg3gAAAAAAOgTEGwAAAABAh4B4AwAAAADoEBBvAAAAAAAdAuINAAAAAKBDQLwBAAAAAHSIRvF2fHw8VTk5ObE9AQAAAADAvGkUbzdu3FA7Ozuty9bWlnr48KHtDQAAAAAA5kmjeLtz5446OvqkPn2icmT/FYXqjvR5XY50+fDhAwu4R48eWQsAAADARWZHjQcDNd6xhwCcklbirSbYPn7UJTqnC4k3KiTc7t27lxFwI7XS66u1bXvYCbbVWr+ner2eWhnZUxcSjAMAAMzEZKhWB2Mt4/LsjAdqECi8iRo29DGQOFxVw4k9zKFjCO1rKK7GjuBzo7V4+6gFGz1VSxWqiwUcnd/Y2LBWJN0Tb9trfdWDWsE4AIHeVFZX6xvBzlgN9PlVLtGThlnrHNxmqD0Txr9p785FBO2JTMyepnoNbXTebxynjKn0lKXQrmi/+0yG7tqiMmfxsCw/WYL7WC4ypMkwMadaiTeC5lV5zkj7/vOZiLfSWivVOQprqJhLCv0iaA4Fw+Ls2pO1Odb6Ps2HRvF2+/ZtFmLv37/n8u7du6C487GIo7K5uWmtSLon3kYrPdXv1qPCGTBP1SptFh9flHEAZcw3fBJMQ528wgRrEqNPeLQp+IQ2a11F9VSCYqhEGSfRIMsawva5mCuoPSXh/Kah45Rx8Qbt4jA+fN+gTlJqV7J/3qB7voxrW5afCH3v8vOoguacn7okDvT9H8eiICqD8cTO55bFzSlr30Ql5hrNs8T6WQyltdhunbp22TWkrzmdS9quUUMo3iK7GqqXMeby0KJoFG+3bt1ikXZ4eKjevHmjDg5eq8njXfXq1StfqI7axALu7t271ooE4u3zBOINTEecvDgZ+kRJULIU3+5nqfNQ8sx8U671J9LtazE7xMaZrE8ifPC3crkRmI2ilsvbtmMK19x56NqWIaqW5ScNb+hSSIkSz7Pqy4ZDz42hPqfXwjAzCQLxJ9FrImXfiwtaM4mYqLSf/6cjuxY1pbriGirlkqnWnonB1NEcqscTxxiM7xJoFG83b970wo2E2q1fdtVX3zxQe3sv1P7+vnr58iXXpQRcUbytrfBvp7g4hbC9pvq9Fd3Ckjy2fcTvrkJRQfaF6BhpP/01LUX4gOtc/7BPGJOrI9vuXM/FkomjZMcg/dt2PjYy2/f9vC8mjLteN7tPQ2S/3w+uj9qvpcYBXGhqCTaZOEtJtUWdo9amIpnoM+3Tm0LlL12fgXy4zYA+R4nb2+JNw24gpXYx0v65IyWq3H0wmyXfv3jDrW3Atm1WeMR+jI+gnZ8rkX9bwtvV5K8Z3uRr127sBvb0tQ7HugzoSVR67vN4RPOJSL5+pZi5LV2nqE/MyWVQWmvFdVhaQ/5eOqq1XeyXgOqGk8R8sYR9hZ8l0Uq8OeG2v/9S/e3qY/XHlRvq+79vqefPn3OhOhZwb0MBlxdvWgAEgk2LClITRfG2rQWEEB0kymxd8Fssfb5P4kOIL/PZihxvQD5ZKsSkCcVhPo6yHVPnqpx/L6Tia/eYfoEgm5fPADkeRHxMbmNhCC4ytcTHG6tIYJQs3fGsdRaTSO0BYfvE7Ry19pZazBp5LlWfJIo59a3b2+K2ZrMstpPEY3LuiEUVYTbAQNjwOOSOyYYUKakNNOEn2uBp/E2fhH+ei9P4K5MWbuY8PWGT88AIMO1TxzoZD4VfCcUgY9LQGAUCxtofDo3Qo3oZNF3jNBcxJ0prrVTXvNbEPRG5pPXas1Ad9U19CSR8vSuZdouiUbxtaPFG4uzg4ECt//REXfvXf9WXX22oL/78T/7vuu3u7vLTNy/gDg/5N3Bl8RaLKHscC5iEoEk+nRLtRitkS/tggSJss+Bx/aqSF3bVcUq0pJ+SFeyQ/1g0BeeM0OKnY7JRqh/blcJzVp8SaZOIj6krxBuoSCY+myxdMqPXPr7JrHXxBh7BSVQmzkL7WszkV/RNXlMEbwLx60yy02ZjaNEuaf/ckRdvwfDE91IeyzkjSjjmKT9ShMn6lBgT51r5I0yfVNtkofk+1nNQ2/e26DqNU/PbNH+cgOr8HJbXVjEh+zkbiTm5DEprrbgOm9aQvE80ti6XNPWLoDpqTv8G+cVS68t+47m2OBrF2/3791mc0SvSv/7wQN2dbKsrP/6q/vCnf6t/3PyfevbsmXrx4gW3ef36tXr79q1/+ra5OUfxxp+FeAjaOhvaNgsTezzSbZxQyYoWohCTJhAtxTjmIaSojxBx2TbOD8QbOBtKic+Q2jgd7etS35hDwg2r1D6MubDJJpI1wYk8ZZsSd9AnJQQ0De2y9s8dqfufGDMp1gh5XBvLFOl5RnOE5kE4V1L3TJxr5a8A9S/dW11v5ib5FOLS+qS5ke1Otnnu1oWbx4k33zZTtL9lUMofpTqOv7CGQsT9n6qficHUmXbxvavHGOahRdMo3ugvRkm43fv1d/XdeFv99vSZerT1RH397QP1l9F/9PFTfnVKbcKnbyTe2vy1qRAbLISqOvN0ywqjSHQEdfaYXpe614fuuBIb5DcWIy1ElyYQLcU4SnZi/0YceVv62teiOtPW9AtEUxDD6XxW4y19EvExuYV4AxXFBKuZNTmHdYkEGz1B4A3YJ+XmhDxrzOw3IQQMkV+5UXA/l9Sb2uXsnzemEW+RMPf9yEbYfjKMbab8aMgu/ZYseOVo/MtNenp/BeheBxcXoetp7pk5WP+L0gH9/i0nDsi2bZd1QdecqmyKa0G0zwExhTUUEdpp34+gvtWwmHsvx6kWI9+DKebDKWkUbz/9/DMLMyrx/wrLndvb2+PP9GpVvjqdWrzREYshevKkhYIWV+HTNXO+XqexT8S82IiEIGPbOBuVMCnHFIqWUhxlO6F/fT764wHy4+z637AxRoT5Onndp/EZjZEfe1sfH0O8AUk9wdrNz282c6jjTbaeYM2m6vqIhJlp7yhvCg31YoOUxedzFhrufBST3HRz7ZrsnytaijeNvNf8u63a2JbGKiPeNHSvw83b+tc+nL3aZtzorwDd31IHXc/XF8Sk45fHZEMc8zVQLMKuO1ebxxR7yn9TXAuitNZqdTzuufsu71Epz2iy/epQDOGwWAFnx9+PfUt786ZRvI1GI3X16lV15coVLpcvj3S57Is7T22uja+p69evc1lfX1eXLl2yVkCS7CvMBXIWPgGYkVKCTzFte3Bxqc+VtHg8LXKTL9om8Vabu5F4YyqBUrLnRa/r/5mJt6noQoxLplG8gXlBT8TiJ2aLfpJ1Fj4BmBf0TTfzmijJtO3BhSV+ksMsRryB00NCFPclBOJtmUSvbZcios7CJwAAfKa4J2F1MQDxBroDxBsAAAAAQIeAeAMAAAAA6BAQbwAAAAAAHQLiDQAAAACgQ0C8AQAAAAB0iEbxdnx8PFU5OTmxPQEAAAAAwHxR6v8nkshQcqXuMAAAAABJRU5ErkJggg==" alt="hwfs" title="hwfs"></p> <p>创建 <code>font.js</code> 并输入以下代码</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> Fontmin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;fontmin&quot;</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> fontmin <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Fontmin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span><span class="token string">&quot;./src/assets/font/huawenfangsong.ttf&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token string">&quot;./src/assets/fontmin/&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>
    Fontmin<span class="token punctuation">.</span><span class="token function">glyph</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      text<span class="token operator">:</span> <span class="token string">&quot;恭喜EDG夺冠1234567890qwertyuiopasdfghjklzxcvbnm&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span>

fontmin<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> files</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> err
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>这是 <code>fontmin</code> 文档上的用法，还有其他用法可以去看看 <code>GitHub</code> 上的文档：<a href="https://github.com/ecomfe/fontmin" target="_blank" rel="noopener noreferrer">fontmin<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="开撸"><a href="#开撸" class="header-anchor">#</a> 开撸</h2> <p>大家应该都看得出来，上面的代码执行了这么一个任务：将 <code>${text}</code> 中的文字从字体包中“抽离”出来，并单独生成一个新的字体包！</p> <p>现在开始操作一下。首先用 <code>node</code> 执行一下命令：</p> <div class="language-shell extra-class"><pre class="language-shell"><code>node .<span class="token punctuation">\</span>font.js
</code></pre></div><p>可以看到输出路径下静静地躺着个字体文件。好家伙，才 <code>13KB</code> 😍！再看看原来的字体包 <code>11MB</code>，整整压缩了 <code>99.9%</code> ！</p> <p><img src="data:image/png;base64,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" alt="fontmin" title="font-min"></p> <p>再来看看页面效果，是不是也能正常显示：</p> <p><img src="/Blog/assets/img/font-res.09e3387d.png" alt="fontmin" title="font-min"></p> <p>对比一下 <code>font.js</code> 与效果图，很明显只要是被“抽离”的文字，都显示为“华文仿宋”字体样式。显然，这就是我们想要的效果！</p> <h2 id="优化"><a href="#优化" class="header-anchor">#</a> 优化</h2> <p>但是！这样还是不够的，实际项目中我们也不可能手动把所有文字都写出来放到 <code>${text}</code> 中去。接下来搞一下读取文件的功能，读取其中包含的所有字符。</p> <p>这个时候，我们就需要借助一下 <code>node</code> 的 <code>fs</code> 模块。码一下代码，看看输出的内容。（记得要 <code>set</code> 一下 😎）</p> <p>这里分享一个插件：<a href="https://marketplace.visualstudio.com/items?itemName=formulahendry.code-runner&amp;ssr=false#review-details" target="_blank" rel="noopener noreferrer">Code Runner<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，可以直接运行代码片段。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;fs&quot;</span><span class="token punctuation">)</span>

fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">&quot;./test.html&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> mySet <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 去重的目的</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>mySet<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>测试页面如下：</p> <p><img src="/Blog/assets/img/font-readFile.89d6723b.png" alt="fontmin" title="font-min"></p> <p>读取结果如下：</p> <p><img src="data:image/png;base64,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" alt="fontmin" title="font-min"></p> <p>搞定！</p> <p>读取这一块已经完成了，但还需要再进一步优化，毕竟项目中不仅仅这么一个文件，所以我们需要增加一个“扫描”文件夹的方法</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;fs&quot;</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> <span class="token function-variable function">scanFolder</span> <span class="token operator">=</span> <span class="token parameter">dir</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> dirRes <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readdirSync</span><span class="token punctuation">(</span>dir<span class="token punctuation">)</span> <span class="token comment">// 读取文件夹，返回一个文件（夹）list</span>
  dirRes<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">list</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> path <span class="token operator">=</span> dir <span class="token operator">+</span> <span class="token string">&quot;/&quot;</span> <span class="token operator">+</span> list
    <span class="token keyword">const</span> statRes <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">statSync</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span> <span class="token comment">// 读取文件详情，判断是否为文件夹</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>statRes<span class="token punctuation">.</span><span class="token function">isDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      result <span class="token operator">=</span> result<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token function">scanFolder</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      result <span class="token operator">=</span> result<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token function">scanFile</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> mySet <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
  <span class="token keyword">return</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>mySet<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">scanFile</span> <span class="token operator">=</span> <span class="token parameter">path</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> res <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span>
  <span class="token keyword">const</span> mySet <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>mySet<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">scanFolder</span><span class="token punctuation">(</span><span class="token string">&quot;./src/views&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>运行结果这里就不展示了，各位看官可以自行操作一下。这里用的都是 <code>fs</code> 的同步方法，稍微注意下校验即可。</p> <p>整个流程已经完成了，可以通过自动扫描文件生成一个字符集，然后再用 <code>fontmin</code> 的 <code>glyph</code> 方法“抽离”出来并生成新的字体文件</p> <p>（Tips：还可以配置一下 <code>npm</code> 命令呦 😄）</p> <h2 id="完整代码"><a href="#完整代码" class="header-anchor">#</a> 完整代码</h2> <p>以下源码来自：<a href="https://zhuanlan.zhihu.com/p/48318293" target="_blank" rel="noopener noreferrer">https://zhuanlan.zhihu.com/p/48318293<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;fs&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> Fontmin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;fontmin&quot;</span><span class="token punctuation">)</span> <span class="token comment">// 需要借助 fontmin 插件</span>
<span class="token keyword">let</span> set <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">//get all possible characters</span>
<span class="token keyword">const</span> <span class="token function-variable function">scanFolder</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">dir<span class="token punctuation">,</span> done</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> results <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  fs<span class="token punctuation">.</span><span class="token function">readdir</span><span class="token punctuation">(</span>dir<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> list</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token function">done</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 这里的立即函数触发了闭包，使results的值一直保存</span>
      <span class="token keyword">let</span> file <span class="token operator">=</span> list<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>file<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// iterator遍历，file不存在即为执行完成状态</span>
        <span class="token keyword">return</span> <span class="token function">done</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> results<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      file <span class="token operator">=</span> dir <span class="token operator">+</span> <span class="token string">&quot;/&quot;</span> <span class="token operator">+</span> file
      fs<span class="token punctuation">.</span><span class="token function">stat</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> stat</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>stat <span class="token operator">&amp;&amp;</span> stat<span class="token punctuation">.</span><span class="token function">isDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">scanFolder</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// 重新调用方法，获取子目录下的目录结构</span>
            results <span class="token operator">=</span> results<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
            <span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          results<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span>
          <span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 执行下一步</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">//get all possible characters</span>
<span class="token keyword">const</span> <span class="token function-variable function">generateFinalHTML</span> <span class="token operator">=</span> <span class="token parameter">finalString</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> fontmin <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Fontmin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span><span class="token string">&quot;./src/assets/font/SourceHanSansCN-Regular.ttf&quot;</span><span class="token punctuation">)</span> <span class="token comment">// 源字体文件路径</span>
    <span class="token punctuation">.</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token string">&quot;./src/assets/font/fontmin/&quot;</span><span class="token punctuation">)</span> <span class="token comment">// 压缩后文件存放路径，最终使用的是这个压缩后的文件</span>
    <span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>
      Fontmin<span class="token punctuation">.</span><span class="token function">glyph</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        text<span class="token operator">:</span> finalString<span class="token punctuation">,</span> <span class="token comment">// 也可以直接指定需要生成的字符集</span>
        hinting<span class="token operator">:</span> <span class="token boolean">false</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>

  fontmin<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> err
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">//get all possible characters</span>
<span class="token comment">// 指定扫描路径，注意路径不同，会导致最终扫描到的字符数不同</span>
<span class="token function">scanFolder</span><span class="token punctuation">(</span><span class="token string">&quot;src/views&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">n<span class="token punctuation">,</span> results</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  results<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">file</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> result <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span> <span class="token string">&quot;utf8&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> currentSet <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
    <span class="token comment">// 获取到每个文件中的字符，并存储到set集中</span>
    set <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">...</span>set<span class="token punctuation">,</span> <span class="token operator">...</span>currentSet<span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token function">generateFinalHTML</span><span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>set<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;共生成：&quot;</span> <span class="token operator">+</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>set<span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">+</span> <span class="token string">&quot;个字符&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="思考"><a href="#思考" class="header-anchor">#</a> 思考</h2> <p>可能已经有看官发现，这个方案只是针对本地（项目下）的文件进行扫描，对于从后端返回来的数据是没办法实现的，就比如用户名...</p> <p>我认为的一个稍微好一点的解决方案，便是将常用的 <code>3000</code> 或 <code>7000</code> 汉字以及字母、数字、符号等生成一个字体文件，其余的使用降级方案</p> <p>如果还不行，那就跟产品 Battle Battle</p> <div style="display:flex;justify-content:center;"><span style="transform:rotateY(180deg);">🤺</span>         <span>🤺</span></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/Real102/Blog/edit/master/docs/blog/html/font.md" target="_blank" rel="noopener noreferrer">Edit in GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">12/28/2021, 4:41:02 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/Blog/blog/html/unicode.html" class="prev">
        字符编码
      </a></span> <span class="next"><a href="/Blog/blog/html/vh.html">
        vh 高度问题
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/Blog/assets/js/app.26c94a5c.js" defer></script><script src="/Blog/assets/js/2.b2fff99d.js" defer></script><script src="/Blog/assets/js/5.b9636d6c.js" defer></script>
  </body>
</html>
