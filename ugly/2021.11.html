<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>笔记 | WolfBerry</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="WolfBerry's Blog">
    
    <link rel="preload" href="/Blog/assets/css/0.styles.582bb75b.css" as="style"><link rel="preload" href="/Blog/assets/js/app.26c94a5c.js" as="script"><link rel="preload" href="/Blog/assets/js/2.b2fff99d.js" as="script"><link rel="preload" href="/Blog/assets/js/14.6d0c4961.js" as="script"><link rel="prefetch" href="/Blog/assets/js/10.07ed30bc.js"><link rel="prefetch" href="/Blog/assets/js/11.4405ba45.js"><link rel="prefetch" href="/Blog/assets/js/12.21f3d656.js"><link rel="prefetch" href="/Blog/assets/js/13.6282d122.js"><link rel="prefetch" href="/Blog/assets/js/15.4904075b.js"><link rel="prefetch" href="/Blog/assets/js/16.3318e70c.js"><link rel="prefetch" href="/Blog/assets/js/17.126dec48.js"><link rel="prefetch" href="/Blog/assets/js/18.f3baeba3.js"><link rel="prefetch" href="/Blog/assets/js/19.d9a0b707.js"><link rel="prefetch" href="/Blog/assets/js/20.4b9c544c.js"><link rel="prefetch" href="/Blog/assets/js/21.82d0e7f1.js"><link rel="prefetch" href="/Blog/assets/js/22.42b8ae09.js"><link rel="prefetch" href="/Blog/assets/js/23.c676b601.js"><link rel="prefetch" href="/Blog/assets/js/24.6e1c47f1.js"><link rel="prefetch" href="/Blog/assets/js/25.310dad1a.js"><link rel="prefetch" href="/Blog/assets/js/26.a7745fbc.js"><link rel="prefetch" href="/Blog/assets/js/27.e451bb4b.js"><link rel="prefetch" href="/Blog/assets/js/28.51707047.js"><link rel="prefetch" href="/Blog/assets/js/29.edfaf11e.js"><link rel="prefetch" href="/Blog/assets/js/3.60a6da4e.js"><link rel="prefetch" href="/Blog/assets/js/30.e25e4396.js"><link rel="prefetch" href="/Blog/assets/js/31.c06c845b.js"><link rel="prefetch" href="/Blog/assets/js/32.cdc8bf6c.js"><link rel="prefetch" href="/Blog/assets/js/33.3de22c63.js"><link rel="prefetch" href="/Blog/assets/js/34.b56e280b.js"><link rel="prefetch" href="/Blog/assets/js/35.4d6ccb74.js"><link rel="prefetch" href="/Blog/assets/js/36.a729c293.js"><link rel="prefetch" href="/Blog/assets/js/37.48a8f1df.js"><link rel="prefetch" href="/Blog/assets/js/38.69b10e03.js"><link rel="prefetch" href="/Blog/assets/js/39.62484b18.js"><link rel="prefetch" href="/Blog/assets/js/4.8dfc73e1.js"><link rel="prefetch" href="/Blog/assets/js/40.7b5c5c55.js"><link rel="prefetch" href="/Blog/assets/js/41.73c45021.js"><link rel="prefetch" href="/Blog/assets/js/42.9f3fc2e2.js"><link rel="prefetch" href="/Blog/assets/js/43.a4bee912.js"><link rel="prefetch" href="/Blog/assets/js/44.acb8c2a6.js"><link rel="prefetch" href="/Blog/assets/js/45.d02eb0a9.js"><link rel="prefetch" href="/Blog/assets/js/46.7f053f0a.js"><link rel="prefetch" href="/Blog/assets/js/47.46c8786e.js"><link rel="prefetch" href="/Blog/assets/js/48.19b67883.js"><link rel="prefetch" href="/Blog/assets/js/49.ce6aa35d.js"><link rel="prefetch" href="/Blog/assets/js/5.b9636d6c.js"><link rel="prefetch" href="/Blog/assets/js/50.2497754c.js"><link rel="prefetch" href="/Blog/assets/js/51.e1c78dcc.js"><link rel="prefetch" href="/Blog/assets/js/52.89262c74.js"><link rel="prefetch" href="/Blog/assets/js/53.47860fb3.js"><link rel="prefetch" href="/Blog/assets/js/54.4d1f45ac.js"><link rel="prefetch" href="/Blog/assets/js/55.b2dac113.js"><link rel="prefetch" href="/Blog/assets/js/56.34c7045e.js"><link rel="prefetch" href="/Blog/assets/js/57.d614f134.js"><link rel="prefetch" href="/Blog/assets/js/58.e88fc109.js"><link rel="prefetch" href="/Blog/assets/js/59.d386972e.js"><link rel="prefetch" href="/Blog/assets/js/6.e72b2b73.js"><link rel="prefetch" href="/Blog/assets/js/60.a3d054ef.js"><link rel="prefetch" href="/Blog/assets/js/61.27b0d020.js"><link rel="prefetch" href="/Blog/assets/js/62.742bc712.js"><link rel="prefetch" href="/Blog/assets/js/63.0cf87451.js"><link rel="prefetch" href="/Blog/assets/js/64.ee8cefe2.js"><link rel="prefetch" href="/Blog/assets/js/65.2a3e00d6.js"><link rel="prefetch" href="/Blog/assets/js/66.c16d7376.js"><link rel="prefetch" href="/Blog/assets/js/67.22d5664d.js"><link rel="prefetch" href="/Blog/assets/js/68.3163821e.js"><link rel="prefetch" href="/Blog/assets/js/69.ba149287.js"><link rel="prefetch" href="/Blog/assets/js/7.8d9b6daa.js"><link rel="prefetch" href="/Blog/assets/js/70.79b3941c.js"><link rel="prefetch" href="/Blog/assets/js/71.9633a5fc.js"><link rel="prefetch" href="/Blog/assets/js/72.0a582a8b.js"><link rel="prefetch" href="/Blog/assets/js/8.f72dab87.js"><link rel="prefetch" href="/Blog/assets/js/9.db5433a8.js">
    <link rel="stylesheet" href="/Blog/assets/css/0.styles.582bb75b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Blog/" class="home-link router-link-active"><!----> <span class="site-name">WolfBerry</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Blog/blog/" class="nav-link">
  Blog
</a></div><div class="nav-item"><a href="/Blog/ugly/" class="nav-link router-link-active">
  Ugly
</a></div><div class="nav-item"><a href="/Blog/gold/" class="nav-link">
  Gold
</a></div><div class="nav-item"><a href="/Blog/diary/" class="nav-link">
  Diary
</a></div> <a href="https://github.com/Real102/Blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Blog/blog/" class="nav-link">
  Blog
</a></div><div class="nav-item"><a href="/Blog/ugly/" class="nav-link router-link-active">
  Ugly
</a></div><div class="nav-item"><a href="/Blog/gold/" class="nav-link">
  Gold
</a></div><div class="nav-item"><a href="/Blog/diary/" class="nav-link">
  Diary
</a></div> <a href="https://github.com/Real102/Blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Ugly</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Blog/ugly/" aria-current="page" class="sidebar-link">介绍</a></li><li><a href="/Blog/ugly/2021.8.html" class="sidebar-link">2021.8</a></li><li><a href="/Blog/ugly/2021.9.html" class="sidebar-link">2021.9</a></li><li><a href="/Blog/ugly/2021.10.html" class="sidebar-link">2021.10</a></li><li><a href="/Blog/ugly/2021.11.html" aria-current="page" class="active sidebar-link">2021.11</a></li><li><a href="/Blog/ugly/2021.12.html" class="sidebar-link">2021.12</a></li><li><a href="/Blog/ugly/2022.1.html" class="sidebar-link">2022.1</a></li><li><a href="/Blog/ugly/2022.2.html" class="sidebar-link">2022.2</a></li><li><a href="/Blog/ugly/2022.3.html" class="sidebar-link">2022.3</a></li><li><a href="/Blog/ugly/2022.4.html" class="sidebar-link">2022.4</a></li><li><a href="/Blog/ugly/2022.5.html" class="sidebar-link">2022.5</a></li><li><a href="/Blog/ugly/2022.6.html" class="sidebar-link">2022.6</a></li><li><a href="/Blog/ugly/2022.7.html" class="sidebar-link">2022.7</a></li><li><a href="/Blog/ugly/2023.1.html" class="sidebar-link">2023.1</a></li><li><a href="/Blog/ugly/2023.2.html" class="sidebar-link">2023.2</a></li><li><a href="/Blog/ugly/测试用例.html" class="sidebar-link">测试用例</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="笔记"><a href="#笔记" class="header-anchor">#</a> 笔记</h1> <h2 id="_2021-年-11-月-1-日"><a href="#_2021-年-11-月-1-日" class="header-anchor">#</a> 2021 年 11 月 1 日</h2> <h3 id="快速删除-node-modules-1-12-补"><a href="#快速删除-node-modules-1-12-补" class="header-anchor">#</a> 快速删除 node_modules（1.12 补）</h3> <p>全局安装 <code>rimraf</code> 插件</p> <div class="language-shell extra-class"><pre class="language-shell"><code>cnpm <span class="token function">install</span> rimraf -g
</code></pre></div><p>然后输入下面一句命令即可：</p> <div class="language-shell extra-class"><pre class="language-shell"><code>rimraf node_modules
<span class="token comment"># 直接输入 node_modules 即可</span>
</code></pre></div><h2 id="_2021-年-11-月-2-日"><a href="#_2021-年-11-月-2-日" class="header-anchor">#</a> 2021 年 11 月 2 日</h2> <h3 id="vscode-调试-vue-项目-3-9-补"><a href="#vscode-调试-vue-项目-3-9-补" class="header-anchor">#</a> Vscode 调试 Vue 项目（3.9 补）</h3> <p>基本流程可以从 <code>vue</code> 官网的 <code>Cookbook</code> 可以查到，这里记录一下需要注意的点：需要开启<code>source-map</code></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">configureWebpack</span><span class="token operator">:</span> <span class="token parameter">config</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    config<span class="token punctuation">.</span>devtool <span class="token operator">=</span> <span class="token string">&quot;source-map&quot;</span>
    <span class="token keyword">return</span> config
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>参考地址：</p> <ul><li><a href="https://cn.vuejs.org/v2/cookbook/debugging-in-vscode.html#%E4%BB%8E-VS-Code-%E5%90%AF%E5%8A%A8%E5%BA%94%E7%94%A8" target="_blank" rel="noopener noreferrer">https://cn.vuejs.org/v2/cookbook/debugging-in-vscode.html#从-VS-Code-启动应用<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://juejin.cn/post/7071219293249077256#heading-1" target="_blank" rel="noopener noreferrer">https://juejin.cn/post/7071219293249077256#heading-1<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="_2021-年-11-月-3-日"><a href="#_2021-年-11-月-3-日" class="header-anchor">#</a> 2021 年 11 月 3 日</h2> <h3 id="取消-watch-监听"><a href="#取消-watch-监听" class="header-anchor">#</a> 取消 watch 监听</h3> <p><code>vue</code> 中的 <code>watch</code> 监听是可以取消的，使用方式如下：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> someWatch <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$watch</span><span class="token punctuation">(</span><span class="token string">&quot;attr&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> options <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">someWatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 取消监听</span>
</code></pre></div><h2 id="_2021-年-11-月-4-日"><a href="#_2021-年-11-月-4-日" class="header-anchor">#</a> 2021 年 11 月 4 日</h2> <h3 id="fixed-祖先"><a href="#fixed-祖先" class="header-anchor">#</a> fixed 祖先</h3> <p><code>position:fixed</code> 的元素会被移出正常文档流，并不为元素预留空间，而是通过指定元素相对于屏幕视口（<code>viewport</code>）的位置来指定元素位置。元素的位置在屏幕滚动时不会改变。<code>fixed</code> 属性会创建新的层叠上下文。当元素祖先的 <code>transform</code>, <code>perspective</code> 或 <code>filter</code> 属性非 <code>none</code> 时，容器由视口改为该祖先。</p> <h2 id="_2021-年-11-月-5-日"><a href="#_2021-年-11-月-5-日" class="header-anchor">#</a> 2021 年 11 月 5 日</h2> <h3 id="对象动态赋值-ts-写法"><a href="#对象动态赋值-ts-写法" class="header-anchor">#</a> 对象动态赋值 ts 写法</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code>  searchData<span class="token operator">:</span> ISearchData <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token punctuation">[</span>propName<span class="token operator">:</span> string<span class="token punctuation">]</span><span class="token operator">:</span> any
  <span class="token punctuation">}</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>searchData<span class="token punctuation">[</span>someAttr <span class="token keyword">as</span> keyof ISearchData<span class="token punctuation">]</span> <span class="token operator">=</span> someValue <span class="token keyword">as</span> any
</code></pre></div><h2 id="_2021-年-11-月-6-日"><a href="#_2021-年-11-月-6-日" class="header-anchor">#</a> 2021 年 11 月 6 日</h2> <p>缺席...</p> <h2 id="_2021-年-11-月-7-日"><a href="#_2021-年-11-月-7-日" class="header-anchor">#</a> 2021 年 11 月 7 日</h2> <p>缺席...</p> <h2 id="_2021-年-11-月-8-日"><a href="#_2021-年-11-月-8-日" class="header-anchor">#</a> 2021 年 11 月 8 日</h2> <h3 id="首屏时间优化-视频"><a href="#首屏时间优化-视频" class="header-anchor">#</a> 首屏时间优化--视频</h3> <p>技术要点：</p> <ul><li>视频资源压缩（小丸工具箱，可移除音频）</li> <li>视频资源格式转换为 <code>flv</code> 格式（借助 <code>B</code> 站开源的 <code>flv.js</code>）</li> <li>其他非首屏资源延后加载</li></ul> <p>完整文档：<a href="https://segmentfault.com/a/1190000021578572" target="_blank" rel="noopener noreferrer">首屏视频的优化过程 🚀<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="首屏时间-白屏时间"><a href="#首屏时间-白屏时间" class="header-anchor">#</a> 首屏时间&amp;白屏时间</h3> <ul><li><p><strong>白屏时间</strong>：从页面打开到出现内容时的时间。浏览器只有加载并解析完头部资源才会真正渲染页面，因此可以通过获取头部资源加载完的时刻来近似（粗略）统计白屏时间</p></li> <li><p><strong>首屏时间</strong>：首屏时间需要考虑各种情况如：图片、<code>iframe</code>、<code>video</code> 等。仅文本时，首屏时间即为 <code>DOMContentLoaded</code> 时间</p></li></ul> <h4 id="performance-api"><a href="#performance-api" class="header-anchor">#</a> performance API</h4> <p>重点关注 <code>performance API</code>，其中包含有：<code>memory</code>、<code>navigation</code>、<code>timeOrigin</code>、<code>timing</code> 四个属性。几乎都可以从这个 <code>API</code> 中拿到相关数值</p> <p>分享个网上搜罗的好东西：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 出处：https://juejin.cn/post/6928739992986615816</span>
window<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> timing <span class="token operator">=</span> performance<span class="token punctuation">.</span>timing
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;准备新页面时间耗时: &quot;</span> <span class="token operator">+</span> timing<span class="token punctuation">.</span>fetchStart <span class="token operator">-</span> timing<span class="token punctuation">.</span>navigationStart<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;redirect 重定向耗时: &quot;</span> <span class="token operator">+</span> timing<span class="token punctuation">.</span>redirectEnd <span class="token operator">-</span> timing<span class="token punctuation">.</span>redirectStart<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Appcache 耗时: &quot;</span> <span class="token operator">+</span> timing<span class="token punctuation">.</span>domainLookupStart <span class="token operator">-</span> timing<span class="token punctuation">.</span>fetchStart<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;unload 前文档耗时: &quot;</span> <span class="token operator">+</span> timing<span class="token punctuation">.</span>unloadEventEnd <span class="token operator">-</span> timing<span class="token punctuation">.</span>unloadEventStart<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;DNS 查询耗时: &quot;</span> <span class="token operator">+</span> timing<span class="token punctuation">.</span>domainLookupEnd <span class="token operator">-</span> timing<span class="token punctuation">.</span>domainLookupStart<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;TCP连接耗时: &quot;</span> <span class="token operator">+</span> timing<span class="token punctuation">.</span>connectEnd <span class="token operator">-</span> timing<span class="token punctuation">.</span>connectStart<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;request请求耗时: &quot;</span> <span class="token operator">+</span> timing<span class="token punctuation">.</span>responseEnd <span class="token operator">-</span> timing<span class="token punctuation">.</span>requestStart<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;白屏时间: &quot;</span> <span class="token operator">+</span> timing<span class="token punctuation">.</span>responseStart <span class="token operator">-</span> timing<span class="token punctuation">.</span>navigationStart<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;请求完毕至DOM加载: &quot;</span> <span class="token operator">+</span> timing<span class="token punctuation">.</span>domInteractive <span class="token operator">-</span> timing<span class="token punctuation">.</span>responseEnd<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;解释dom树耗时: &quot;</span> <span class="token operator">+</span> timing<span class="token punctuation">.</span>domComplete <span class="token operator">-</span> timing<span class="token punctuation">.</span>domInteractive<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;从开始至load总耗时: &quot;</span> <span class="token operator">+</span> timing<span class="token punctuation">.</span>loadEventEnd <span class="token operator">-</span> timing<span class="token punctuation">.</span>navigationStart<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>另外，获取首屏时间可以用 <code>performance.getEntries()</code> 获取 <code>first-contentful-paint</code> 的时间</p> <h4 id="手打-网参-代码"><a href="#手打-网参-代码" class="header-anchor">#</a> 手打（网参）代码</h4> <p>白屏时间：</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- 代码来源：https://fex.baidu.com/blog/2014/05/build-performance-monitor-in-7-days/ --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
      <span class="token comment">//测试时间起点，实际统计起点为 DNS 查询，即navigationStart时间</span>
      <span class="token keyword">var</span> start_time <span class="token operator">=</span> <span class="token operator">+</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 3s 后这个 js 才会返回 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>script.php<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
      <span class="token keyword">var</span> end_time <span class="token operator">=</span> <span class="token operator">+</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//时间终点</span>
      <span class="token keyword">var</span> headtime <span class="token operator">=</span> end_time <span class="token operator">-</span> start_time <span class="token comment">//头部资源加载时间</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>headtime<span class="token punctuation">)</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>在头部资源加载完之前页面将是白屏<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>script.php 被模拟设置 3s 后返回，head 底部内嵌 JS 等待前面 js 返回后才执行<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>script.php 替换成一个执行长时间循环的 js 效果也一样<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>首屏时间：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 自己用的谷歌，没有那么严谨，不能直接用navigationStart作为开始时间哈</span>
<span class="token comment">// 这里应该在head标签开始时插入一个获取时间戳的代码</span>
<span class="token keyword">let</span> max <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">let</span> imgs <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">&quot;img&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 获取所有的图片资源</span>
imgs<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">tag</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  tag<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 监听每一个图片的onload事件</span>
    <span class="token function">imgLoad</span><span class="token punctuation">(</span>tag<span class="token punctuation">,</span> tag<span class="token punctuation">.</span>classList<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">function</span> <span class="token function">imgLoad</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// name没啥用，测试的时候拿来当名字用了</span>
  target<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>time <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name <span class="token operator">+</span> <span class="token string">&quot;加载时间：&quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> performance<span class="token punctuation">.</span>timing<span class="token punctuation">.</span>navigationStart<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">let</span> io <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IntersectionObserver</span><span class="token punctuation">(</span><span class="token parameter">entries</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>entries<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>intersectionRatio <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 过滤非首屏的图片</span>
      max <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>max<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>max<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    io<span class="token punctuation">.</span><span class="token function">unobserve</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  io<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div> <p>疑问：</p> <ul><li>video 视频是否会影响到首屏时间？</li></ul> <h2 id="_2021-年-11-月-9-日"><a href="#_2021-年-11-月-9-日" class="header-anchor">#</a> 2021 年 11 月 9 日</h2> <h3 id="telepot"><a href="#telepot" class="header-anchor">#</a> telepot</h3> <p>控制某个 <code>HTML</code> 模块（组件）挂载到指定的 <code>DOM</code> 下。使用方式如下，也可以通过 <code>id</code> 指定挂载的 <code>DOM</code>（<code>to=&quot;#target&quot;</code>）。但需要注意，挂载的位置不会影响到原先的父子结构，即不会影响父组件的数据注入</p> <p>如果有多个 <code>teleport</code> 挂载到同一个目标下，<code>teleport</code> 将会按照先后顺序插入到目标 <code>DOM</code> 下（感觉层级比较乱或出现问题的情况下会用的比较多吧，另外其实跟 <code>element ui</code> 的 <code>modal-append-to-body</code> 的效果差不多，不过 <code>teleport</code> 可以指定挂载的 <code>DOM</code>）</p> <div class="language-HTML extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>teleport</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>body<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>teleport<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>teleport</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="_2021-年-11-月-10-日"><a href="#_2021-年-11-月-10-日" class="header-anchor">#</a> 2021 年 11 月 10 日</h2> <h3 id="全局引入方式"><a href="#全局引入方式" class="header-anchor">#</a> 全局引入方式</h3> <h4 id="全局变量"><a href="#全局变量" class="header-anchor">#</a> 全局变量</h4> <p><code>vue3</code> 中 <code>vue.property</code> 已被替换成 <code>config.globalProperties</code>。由于 <code>composition API</code> 中的 <code>this</code> 已经不是我们 <code>vue2</code> 中认识的 <code>this</code>，因此我们需要通过 <code>getCurrentInstance()</code> 方法来获取到当前实例</p> <p>此时访问全局变量的方式则变成：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// main.js</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">createApp</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span>config<span class="token punctuation">.</span>globalProperties<span class="token punctuation">.</span><span class="token function-variable function">$http</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">// home.vue</span>
<span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> $http <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">getCurrentInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>appContext<span class="token punctuation">.</span>config<span class="token punctuation">.</span>globalProperties
<span class="token punctuation">}</span>

</code></pre></div><p>尽管作为 <code>vue.property</code> 的一种替代方案，但 <code>vue3</code> 官方文档仍建议用 <code>provide</code> 替代 <code>globalProperties</code></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// main.js</span>
app<span class="token punctuation">.</span><span class="token function">provide</span><span class="token punctuation">(</span><span class="token string">'guide'</span><span class="token punctuation">,</span> <span class="token string">'Vue 3 Guide'</span><span class="token punctuation">)</span>

<span class="token comment">// home.vue</span>
<span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">inject</span><span class="token punctuation">(</span><span class="token string">'guide'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// Warning：inject() can only be used inside setup() or functional components.</span>
</code></pre></div><h4 id="指令、组件、插件等"><a href="#指令、组件、插件等" class="header-anchor">#</a> 指令、组件、插件等</h4> <p>这里以 component 组件为例（其他类似）</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// /testComp/index.js</span>
<span class="token comment">// install方法同vue2</span>
<span class="token keyword">import</span> comp <span class="token keyword">from</span> <span class="token string">&quot;./index.vue&quot;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">install</span><span class="token operator">:</span> <span class="token parameter">app</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    app<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">&quot;testComp&quot;</span><span class="token punctuation">,</span> comp<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// main.js</span>
<span class="token comment">// 需要use一下</span>
<span class="token keyword">import</span> testComp <span class="token keyword">from</span> <span class="token string">&quot;./components/testComp&quot;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">createApp</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>testComp<span class="token punctuation">)</span>
</code></pre></div><h2 id="_2021-年-11-月-11-日"><a href="#_2021-年-11-月-11-日" class="header-anchor">#</a> 2021 年 11 月 11 日</h2> <h3 id="我想不到系列之-图片的优化"><a href="#我想不到系列之-图片的优化" class="header-anchor">#</a> 我想不到系列之 -- 图片的优化</h3> <p>给图片加上 width、height 属性有利于 CLS（Cumulative Layout Shift 累积布局偏移）优化，通俗一点来说就是可以减少页面的重绘和回流</p> <p>为什么可以减少页面重绘和回流？在设置了 width、height 属性之后，浏览器会根据图像的宽高属性设置图像的默认宽高比，因此开发者只要设置了宽高其中一个的数值时，浏览器便能计算出另外一个的数值</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- 注意是不带单位的width、height值 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xxx.png<span class="token punctuation">&quot;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>300<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>150<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre></div><div class="language-css extra-class"><pre class="language-css"><code><span class="token comment">/* 在谷歌img会多了这么一个默认属性： */</span>
<span class="token selector">img[Attributes Style]</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 313px<span class="token punctuation">;</span>
  <span class="token property">aspect-ratio</span><span class="token punctuation">:</span> auto 313 / 428<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 428px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>参考文档：<a href="https://web.dev/optimize-cls/?utm_source=lighthouse&amp;utm_medium=devtools#images-without-dimensions" target="_blank" rel="noopener noreferrer">优化 Cumulative Layout Shift 累积布局偏移 🚀<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="_2021-年-11-月-12-日"><a href="#_2021-年-11-月-12-日" class="header-anchor">#</a> 2021 年 11 月 12 日</h2> <h3 id="event-bus"><a href="#event-bus" class="header-anchor">#</a> Event Bus</h3> <p><code>vue3</code> 中已废除 <code>$on</code>、<code>$off</code>、<code>$once</code> 实例方法，不能再像 <code>vue2</code> 一样使用。但 <code>vue3</code> 也提供了替换的方法：<a href="https://github.com/developit/mitt" target="_blank" rel="noopener noreferrer">mitt<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>、<a href="https://github.com/scottcorgan/tiny-emitter" target="_blank" rel="noopener noreferrer">tiny-emitter<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>建议少用...</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// tiny-emitter使用如下：</span>
<span class="token keyword">import</span> Emitter <span class="token keyword">from</span> <span class="token string">&quot;tiny-emitter&quot;</span>
<span class="token keyword">const</span> emitter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Emitter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 绑定为全局可用或provide全局注入</span>
app<span class="token punctuation">.</span>config<span class="token punctuation">.</span>globalProperties<span class="token punctuation">.</span>emitter <span class="token operator">=</span> emitter

<span class="token comment">// 触发与监听事件</span>
<span class="token comment">// emitter.on('some-event', function (arg1, arg2, arg3) {})</span>
<span class="token comment">// emitter.emit('some-event', 'arg1 value', 'arg2 value', 'arg3 value')</span>
</code></pre></div><h3 id="attrs、-listeners"><a href="#attrs、-listeners" class="header-anchor">#</a> $attrs、$listeners</h3> <p><code>vue3</code> 中已经废除了 <code>$listeners</code>，在 <code>vue3</code> 的虚拟 <code>DOM</code> 中，事件监听器现在只是以 <code>on</code> 为前缀的 <code>attribute</code>，这样它就成为了 <code>$attrs</code> 对象的一部分，且可以通过 context.attrs[target] 访问</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-bind</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$attrs<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="_2021-年-11-月-13-日"><a href="#_2021-年-11-月-13-日" class="header-anchor">#</a> 2021 年 11 月 13 日</h2> <h3 id="keep-alive"><a href="#keep-alive" class="header-anchor">#</a> keep-alive</h3> <p><code>vue</code> 缓存组件选项，常用于 <code>router-view</code> 或动态组件</p> <div class="language-Vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>keep-alive</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-view</span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>keep-alive</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><code>keep-alive</code> 还支持以下几个参数：</p> <ul><li><code>include</code> - 字符串或正则表达式，只有名称匹配的组件会被缓存</li> <li><code>exclude</code> - 字符串或正则表达式，任何名称匹配的组件都不会被缓存</li> <li><code>max</code> - 数字，最多可以缓存多少组件实例</li></ul> <p><code>include/exclude</code> 匹配首先检查组件自身的 <code>name</code> 选项，如果 <code>name</code> 选项不可用，则匹配它的局部注册名称 (父组件 <code>components</code> 选项的键值)。匿名组件不能被匹配</p> <p>Tips：<code>name</code> 对大小写敏感</p> <h2 id="_2021-年-11-月-14-日"><a href="#_2021-年-11-月-14-日" class="header-anchor">#</a> 2021 年 11 月 14 日</h2> <h3 id="vuex-commit"><a href="#vuex-commit" class="header-anchor">#</a> vuex-commit</h3> <p>提交 <code>mutation</code> 方法：<code>commit(type: string, payload?: any, options?: Object)</code>，有三个可选参数：</p> <ul><li><code>type</code>：事件类型，即提交的 <code>mutation</code> 类型</li> <li><code>payload</code>：载荷，也就是需要传递的参数</li> <li><code>options</code>：包含一个选项：<code>root: true</code>，它允许在命名空间模块里提交根的 <code>mutation</code></li></ul> <h2 id="_2021-年-11-月-15-日"><a href="#_2021-年-11-月-15-日" class="header-anchor">#</a> 2021 年 11 月 15 日</h2> <p>缺席...</p> <h2 id="_2021-年-11-月-16-日"><a href="#_2021-年-11-月-16-日" class="header-anchor">#</a> 2021 年 11 月 16 日</h2> <p>缺席...</p> <h2 id="_2021-年-11-月-17-日"><a href="#_2021-年-11-月-17-日" class="header-anchor">#</a> 2021 年 11 月 17 日</h2> <p>缺席...</p> <h2 id="_2021-年-11-月-18-日"><a href="#_2021-年-11-月-18-日" class="header-anchor">#</a> 2021 年 11 月 18 日</h2> <h3 id="fs-stat-path-options-callback"><a href="#fs-stat-path-options-callback" class="header-anchor">#</a> fs.stat(path[, options], callback)</h3> <p>获取指定路径的统计信息</p> <p><code>callback</code> 包含两个参数 <code>err</code>、<code>stats</code>，<code>stats</code> 即为统计信息，可以通过 <code>stats.isDirectory()</code> 判断是否为文件夹</p> <p>不推荐在调用 <code>fs.open()</code>、<code>fs.readFile()</code> 或 <code>fs.writeFile()</code> 之前使用 <code>fs.stat()</code> 检查文件是否存在。 而是用户代码应该直接打开/读取/写入文件，并在文件不可用时处理引发的错误。</p> <p>要检查文件是否存在而不对其进行操作，建议使用 <code>fs.access()</code>。</p> <h2 id="_2021-年-11-月-19-日"><a href="#_2021-年-11-月-19-日" class="header-anchor">#</a> 2021 年 11 月 19 日</h2> <p>缺席...</p> <h2 id="_2021-年-11-月-20-日"><a href="#_2021-年-11-月-20-日" class="header-anchor">#</a> 2021 年 11 月 20 日</h2> <p>缺席...</p> <h2 id="_2021-年-11-月-21-日"><a href="#_2021-年-11-月-21-日" class="header-anchor">#</a> 2021 年 11 月 21 日</h2> <h3 id="获取依赖的版本号"><a href="#获取依赖的版本号" class="header-anchor">#</a> 获取依赖的版本号</h3> <p>通过 <code>package.json</code> 拿到版本号。一行代码搞定~</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> version <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;axios/package.json&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>version
</code></pre></div><h2 id="_2021-年-11-月-22-日"><a href="#_2021-年-11-月-22-日" class="header-anchor">#</a> 2021 年 11 月 22 日</h2> <h3 id="vue-element-admin-在线换肤功能"><a href="#vue-element-admin-在线换肤功能" class="header-anchor">#</a> vue-element-admin 在线换肤功能</h3> <p>主要逻辑为：获取当前 <code>element-ui</code> 版本，指定版本下载 <code>element-ui</code> 的样式文件，获取用户选择的颜色，重新计算各种 <code>ThemeCluster</code>、<code>ShadeColor</code> 等，利用正则将样式文件中的 <code>css</code> 替换成计算出来的结果</p> <p>相关代码如下：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>chalk<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 如果样式文件不存在，则重新获取一份指定版本的css文件</span>
  <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">https://unpkg.com/element-ui@</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>version<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/lib/theme-chalk/index.css</span><span class="token template-punctuation string">`</span></span>
  <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getCSSString</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token string">&quot;chalk&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> chalkHandler <span class="token operator">=</span> <span class="token function">getHandler</span><span class="token punctuation">(</span><span class="token string">&quot;chalk&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;chalk-style&quot;</span><span class="token punctuation">)</span>

<span class="token function">chalkHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// oldVal 为旧的主题色，默认值为 ORIGINAL_THEME</span>
<span class="token keyword">const</span> styles <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">&quot;style&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">style</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> text <span class="token operator">=</span> style<span class="token punctuation">.</span>innerText
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span>oldVal<span class="token punctuation">,</span> <span class="token string">&quot;i&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">Chalk Variables</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

styles<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">style</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> innerText <span class="token punctuation">}</span> <span class="token operator">=</span> style
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> innerText <span class="token operator">!==</span> <span class="token string">&quot;string&quot;</span><span class="token punctuation">)</span> <span class="token keyword">return</span>
  style<span class="token punctuation">.</span>innerText <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateStyle</span><span class="token punctuation">(</span>innerText<span class="token punctuation">,</span> originalCluster<span class="token punctuation">,</span> themeCluster<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="_2021-年-11-月-23-日"><a href="#_2021-年-11-月-23-日" class="header-anchor">#</a> 2021 年 11 月 23 日</h2> <h3 id="禁止-input-自动补全"><a href="#禁止-input-自动补全" class="header-anchor">#</a> 禁止 input 自动补全</h3> <p>特别是账号密码输入框，不仅自动补全，还有丑的要命的背景色，看着就想干掉它。</p> <p>相关方法测试情况：</p> <ul><li>如果直接使用：<code>autocomplete=&quot;off&quot;</code>，兼容性也不太 ok （<a href="https://caniuse.com/?search=autocomplete" target="_blank" rel="noopener noreferrer">查看兼容性<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>）</li> <li>针对密码输入框使用：<code>autocomplete=&quot;new-password&quot;</code>基本可以兼容</li> <li>新增 <code>&lt;input type=&quot;password&quot; autocomplete=&quot;off&quot; style=&quot;position:absolute;top:-9999px;opacity:0&quot; /&gt;</code>，兼容性一半一半，部分浏览器（下表 × 部分）<code>input[text]</code> 仍然会自动填充</li> <li>新增 <code>&lt;input type=&quot;password&quot; autocomplete=&quot;new-password&quot; style=&quot;position:absolute;top:-9999px;opacity:0&quot; /&gt;</code>基本可以兼容（注意 <code>element-ui</code> 下需要放在 <code>el-form</code> 下才会生效）</li></ul> <table><thead><tr><th></th> <th>谷歌</th> <th>火狐</th> <th>edge</th> <th>opera</th></tr></thead> <tbody><tr><td>autocomplete=off</td> <td>×</td> <td>√</td> <td>×</td> <td>×</td></tr> <tr><td>autocomplete=new-password</td> <td>√</td> <td>√</td> <td>√</td> <td>√</td></tr> <tr><td>新增空白 input[password]</td> <td>×</td> <td>√</td> <td>×</td> <td>×</td></tr> <tr><td>新增空白 input[password] + new-password</td> <td>√</td> <td>√</td> <td>√</td> <td>√</td></tr></tbody></table> <p><code>千万别手下留情，淦它</code></p> <p>如果只是想干掉背景色，可以看<a href="https://real102.github.io/Blog/ugly/2021.10.html#%E8%BE%93%E5%85%A5%E6%A1%86%E8%87%AA%E5%8A%A8%E5%A1%AB%E5%85%85%E6%A0%B7%E5%BC%8F%E4%BC%98%E5%8C%96-11-23-%E8%A1%A5" target="_blank" rel="noopener noreferrer">这里<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="_2021-年-11-月-24-日"><a href="#_2021-年-11-月-24-日" class="header-anchor">#</a> 2021 年 11 月 24 日</h2> <h3 id="内网穿透工具-frp-12-27-补"><a href="#内网穿透工具-frp-12-27-补" class="header-anchor">#</a> 内网穿透工具 frp（12.27 补）</h3> <p>需要配置两个端：服务端 <code>frps</code> 和客户端 <code>frpc</code>。</p> <p>服务端 <code>frps</code> 通常部署在具有公网 <code>IP</code> 的机器上（云服务器），客户端则部署在需要穿透的机器上。映射的是本地 <code>localhost</code>。用户通过访问服务端 <code>frps</code>，由 <code>frp</code> 根据端口转发到对应的内网机器，从而实现通信</p> <p>文档地址：<a href="https://gofrp.org/docs/examples/ssh/" target="_blank" rel="noopener noreferrer">https://gofrp.org/docs/examples/ssh/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>其他穿透工具：<code>NATAPP</code>。</p> <p>两者相比较下，<code>frp</code> 的优势在于可以自定义转发的端口，而 <code>NATAPP</code> 则是自动生成 <code>IP</code> + 端口，并且有并行连接数上限（好像是 <code>5</code> 个）</p> <h2 id="_2021-年-11-月-25-日"><a href="#_2021-年-11-月-25-日" class="header-anchor">#</a> 2021 年 11 月 25 日</h2> <h3 id="splitchunks-小-tips"><a href="#splitchunks-小-tips" class="header-anchor">#</a> splitChunks 小 tips</h3> <p>在提取公共 chunk 时，主要利用的就是一下的两个配置项：</p> <p><code>minChunks</code>：包的最小引用次数<br> <code>minSize</code>：包的最小体积</p> <p><s>但实际上模块只有同时满足以上两个条件才会被提取到一个单独的 <code>chunk</code> 中去</s><br>
切割代码块与否跟 <code>chunks</code> 配置有关</p> <h2 id="_2021-年-11-月-26-日"><a href="#_2021-年-11-月-26-日" class="header-anchor">#</a> 2021 年 11 月 26 日</h2> <h3 id="provide-this-1-月-2-日补"><a href="#provide-this-1-月-2-日补" class="header-anchor">#</a> provide this（1 月 2 日补）</h3> <p>源自 <code>element-ui</code> 的代码：<code>ElBreadcrumb</code>，将父组件的 <code>this</code> 通过 <code>provide</code> 注入到子孙组件，子孙组件再通过该 <code>this</code> 获取父组件的内容</p> <p>疑问：不可以通过 <code>this.$parent</code> 来访问父组件吗？</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">provide</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    elBreadcrumb<span class="token operator">:</span> <span class="token keyword">this</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code>inject<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'elBreadcrumb'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>separator <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>elBreadcrumb<span class="token punctuation">.</span>separator<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>separatorClass <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>elBreadcrumb<span class="token punctuation">.</span>separatorClass<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_2021-年-11-月-27-日"><a href="#_2021-年-11-月-27-日" class="header-anchor">#</a> 2021 年 11 月 27 日</h2> <h3 id="network-timing-面板-1-6-补"><a href="#network-timing-面板-1-6-补" class="header-anchor">#</a> Network - Timing 面板（1.6 补）</h3> <p>浏览器开发者工具的网络面板，点击任意一个网络请求，可以在右侧看到 <code>Timing</code> 时序面板，以下为时序面板各项的描述</p> <p><img src="/Blog/assets/img/timing.f1faf936.png" alt="Timing" title="Timing"></p> <ul><li><code>Queueing</code>：浏览器在以下情况下对请求进行排队：更高优先级请求；已为此源打开六个 <code>TCP</code> 连接（仅适用于 <code>HTTP/1.0</code> 和 <code>HTTP/1.1</code>）；浏览器在磁盘缓存中短暂分配空间</li> <li><code>Stalled</code>：请求可能因排队中描述的任何原因而停止。</li> <li><code>DNS Lookup</code>：浏览器正在解析请求的 <code>IP</code> 地址。</li> <li><code>Initial connection</code>：浏览器正在建立连接，包括 <code>TCP</code> 握手/重试和协商 <code>SSL</code>。</li> <li><code>Proxy negotiation</code>：浏览器正在与代理服务器协商请求。</li> <li><code>Request sent</code>：正在发送请求。</li> <li><code>ServiceWorker Preparation</code>：浏览器正在启动 <code>Service Worker</code>。</li> <li><code>Request to ServiceWorker</code>：请求正在发送给服务工作者。</li> <li><code>Waiting (TTFB - Time To First Byte)</code>：浏览器正在等待响应的第一个字节。此时间包括 <code>1</code> 次往返延迟和服务器准备响应所用的时间。</li> <li><code>Content Download</code>：浏览器直接从网络或 <code>Service Worker</code> 接收响应。该值是阅读响应正文所花费的总时间。大于预期的值可能表示网络速度较慢，或者浏览器正忙于执行其他工作，从而延迟了响应的读取。</li> <li><code>Receiving Push</code>：浏览器正在通过 <code>HTTP/2</code> 服务器推送接收此响应的数据。</li> <li><code>Reading Push</code>：浏览器正在读取之前接收到的本地数据。</li></ul> <p>文档地址：<a href="https://developer.chrome.com/docs/devtools/network/reference/#timing-explanation" target="_blank" rel="noopener noreferrer">https://developer.chrome.com/docs/devtools/network/reference/#timing-explanation<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="_2021-年-11-月-28-日"><a href="#_2021-年-11-月-28-日" class="header-anchor">#</a> 2021 年 11 月 28 日</h2> <h3 id="inline"><a href="#inline" class="header-anchor">#</a> inline</h3> <p>认识一下 <code>inline</code> 的庐山真面目</p> <p>如果给 <code>HTML</code> 标签增加 <code>display: inline</code> 属性，会发现块级标签变成了行内标签，而行内标签则保持原样，并且都 “失去” 了宽和高，似乎变成了真正的行内标签。这种情况会出现在除了 <code>img</code>、<code>video</code> 外的其他标签（暂时知道的，可能会有其他）</p> <p><code>display: inline</code> 还会受到 <a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/vertical-align" target="_blank" rel="noopener noreferrer">vertical-align 🚀<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 的影响（内联元素的对齐方式由属性 <code>vertical-align</code> 决定），默认会以 <code>baseline</code>（父元素基线）展示。当父元素有一定高度，并且包含图片和文字两种形式的时候，会发现两者是没有对齐的，也就是 <code>vertical-align</code> 的默认值导致，因此需要自己手动来调整</p> <p>因此，在使用 <code>inline</code> 属性的时候需要多加小心，避免踩雷：</p> <ul><li><code>inline</code> 属性会导致宽高失效</li> <li><code>inline</code> 属性会受到 <code>vertical-align：baseline</code> 的影响</li> <li>注意文本是否已经对齐</li></ul> <h3 id="inline-block"><a href="#inline-block" class="header-anchor">#</a> inline-block</h3> <p>认识一下 <code>inline-block</code> 黑纱下的面容</p> <p>现有以下这么一个 <code>HTML</code> 结构，如果给所有 <code>span</code> 标签加上 <code>inline-block</code> 属性后，应该都知道会出现这样的情况：<code>span</code> 都排列在一行，并且每个 <code>span</code> 之间有个间隔</p> <p>这是由<strong>空白符</strong>导致，比如：空格(U+0020)、制表符(U+0009)、换行(U+000A)、回车(U+000D)、换页(U+000C)等在文档中，产生的表现形式即为空白符</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>111<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>222<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>333<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>444<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>555<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>展现效果如下：</p> <p><img src="data:image/png;base64,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" alt="inline-block" title="inline-block"></p> <p>常见的解决方案有：</p> <ol><li>设置父元素的 <code>font-size</code> 为 <code>0</code>，可以达到消除间隙的效果，但需要对每一个内联元素设置 <code>font-size</code></li> <li>消除内联标签之间的换行符、空格符等（但代码会变得很不美观，不太建议...）</li> <li>其他使用 letter-spacing 或 word-spacing 的感觉不太 ok</li></ol> <p>参考文档地址：<a href="https://github.com/XXHolic/blog/issues/13" target="_blank" rel="noopener noreferrer">https://github.com/XXHolic/blog/issues/13 🚀<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="_2021-年-11-月-29-日"><a href="#_2021-年-11-月-29-日" class="header-anchor">#</a> 2021 年 11 月 29 日</h2> <h3 id="认识高阶函数"><a href="#认识高阶函数" class="header-anchor">#</a> 认识高阶函数</h3> <p><code>高阶函数</code>：是一个接收函数作为参数或将函数作为输出返回的函数。</p> <p>通俗一点就是，将函数当输入或输出的函数...</p> <p>可能听起来还是有点绕，不过平时我们也肯定或多或少用过高阶函数：</p> <ul><li><code>Array.prototype.map</code></li> <li><code>Array.prototype.filter</code></li> <li><code>Array.prototype.reduce</code></li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> array1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span>
<span class="token keyword">const</span> <span class="token function-variable function">reducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">previousValue<span class="token punctuation">,</span> currentValue</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> previousValue <span class="token operator">+</span> currentValue

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>array1<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span>reducer<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// expected output: 10</span>
</code></pre></div><h2 id="_2021-年-11-月-30-日"><a href="#_2021-年-11-月-30-日" class="header-anchor">#</a> 2021 年 11 月 30 日</h2> <h3 id="变量提升"><a href="#变量提升" class="header-anchor">#</a> 变量提升</h3> <p><code>ES6</code> 新增了 <code>let</code> 和 <code>const</code> 命令，加上 <code>var</code> 总共三种定义变量的方式</p> <p>其中 <code>var</code> 存在变量提升，也就是在定义变量前可以访问，且值为 <code>undefined</code></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span> <span class="token comment">// undefined</span>
<span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token string">&quot;string&quot;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span> <span class="token comment">// string</span>
</code></pre></div><p>而对于 <code>let</code> 和 <code>const</code> 命令，则没有变量提升。在定义变量前访问该变量会直接报错</p> <blockquote><p><code>ES6</code> 明确规定，如果区块中存在 <code>let</code> 和 <code>const</code> 命令，这个区块对这些命令声明的变量，从一开始就形成了封闭作用域。凡是在声明之前就使用这些变量，就会报错。</p></blockquote> <p>函数也有变量提升，并且<strong>优先级是高于变量</strong>。但需要注意函数不同的定义方式也会有区别</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>getName<span class="token punctuation">)</span> <span class="token comment">// ƒ getName() { console.log(&quot;getName&quot;) }</span>
<span class="token keyword">function</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;getName&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>getAge<span class="token punctuation">)</span> <span class="token comment">// undefined</span>
<span class="token comment">// 对象字面量方式定义函数，会将getAge先提升，初始化为undefined，</span>
<span class="token comment">// 然后再执行function的赋值操作。所以这种函数的提升不会在最前面</span>
<span class="token keyword">var</span> <span class="token function-variable function">getAge</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;getAge&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/Real102/Blog/edit/master/docs/ugly/2021.11.md" target="_blank" rel="noopener noreferrer">Edit in GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">6/2/2022, 9:06:44 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/Blog/ugly/2021.10.html" class="prev">
        2021.10
      </a></span> <span class="next"><a href="/Blog/ugly/2021.12.html">
        2021.12
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/Blog/assets/js/app.26c94a5c.js" defer></script><script src="/Blog/assets/js/2.b2fff99d.js" defer></script><script src="/Blog/assets/js/14.6d0c4961.js" defer></script>
  </body>
</html>
