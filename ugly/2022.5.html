<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>笔记 | WolfBerry</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="WolfBerry's Blog">
    
    <link rel="preload" href="/Blog/assets/css/0.styles.582bb75b.css" as="style"><link rel="preload" href="/Blog/assets/js/app.26c94a5c.js" as="script"><link rel="preload" href="/Blog/assets/js/2.b2fff99d.js" as="script"><link rel="preload" href="/Blog/assets/js/64.ee8cefe2.js" as="script"><link rel="prefetch" href="/Blog/assets/js/10.07ed30bc.js"><link rel="prefetch" href="/Blog/assets/js/11.4405ba45.js"><link rel="prefetch" href="/Blog/assets/js/12.21f3d656.js"><link rel="prefetch" href="/Blog/assets/js/13.6282d122.js"><link rel="prefetch" href="/Blog/assets/js/14.6d0c4961.js"><link rel="prefetch" href="/Blog/assets/js/15.4904075b.js"><link rel="prefetch" href="/Blog/assets/js/16.3318e70c.js"><link rel="prefetch" href="/Blog/assets/js/17.126dec48.js"><link rel="prefetch" href="/Blog/assets/js/18.f3baeba3.js"><link rel="prefetch" href="/Blog/assets/js/19.d9a0b707.js"><link rel="prefetch" href="/Blog/assets/js/20.4b9c544c.js"><link rel="prefetch" href="/Blog/assets/js/21.82d0e7f1.js"><link rel="prefetch" href="/Blog/assets/js/22.42b8ae09.js"><link rel="prefetch" href="/Blog/assets/js/23.c676b601.js"><link rel="prefetch" href="/Blog/assets/js/24.6e1c47f1.js"><link rel="prefetch" href="/Blog/assets/js/25.310dad1a.js"><link rel="prefetch" href="/Blog/assets/js/26.a7745fbc.js"><link rel="prefetch" href="/Blog/assets/js/27.e451bb4b.js"><link rel="prefetch" href="/Blog/assets/js/28.51707047.js"><link rel="prefetch" href="/Blog/assets/js/29.edfaf11e.js"><link rel="prefetch" href="/Blog/assets/js/3.60a6da4e.js"><link rel="prefetch" href="/Blog/assets/js/30.e25e4396.js"><link rel="prefetch" href="/Blog/assets/js/31.c06c845b.js"><link rel="prefetch" href="/Blog/assets/js/32.cdc8bf6c.js"><link rel="prefetch" href="/Blog/assets/js/33.3de22c63.js"><link rel="prefetch" href="/Blog/assets/js/34.b56e280b.js"><link rel="prefetch" href="/Blog/assets/js/35.4d6ccb74.js"><link rel="prefetch" href="/Blog/assets/js/36.a729c293.js"><link rel="prefetch" href="/Blog/assets/js/37.48a8f1df.js"><link rel="prefetch" href="/Blog/assets/js/38.69b10e03.js"><link rel="prefetch" href="/Blog/assets/js/39.62484b18.js"><link rel="prefetch" href="/Blog/assets/js/4.8dfc73e1.js"><link rel="prefetch" href="/Blog/assets/js/40.7b5c5c55.js"><link rel="prefetch" href="/Blog/assets/js/41.73c45021.js"><link rel="prefetch" href="/Blog/assets/js/42.9f3fc2e2.js"><link rel="prefetch" href="/Blog/assets/js/43.a4bee912.js"><link rel="prefetch" href="/Blog/assets/js/44.acb8c2a6.js"><link rel="prefetch" href="/Blog/assets/js/45.d02eb0a9.js"><link rel="prefetch" href="/Blog/assets/js/46.7f053f0a.js"><link rel="prefetch" href="/Blog/assets/js/47.46c8786e.js"><link rel="prefetch" href="/Blog/assets/js/48.19b67883.js"><link rel="prefetch" href="/Blog/assets/js/49.ce6aa35d.js"><link rel="prefetch" href="/Blog/assets/js/5.b9636d6c.js"><link rel="prefetch" href="/Blog/assets/js/50.2497754c.js"><link rel="prefetch" href="/Blog/assets/js/51.e1c78dcc.js"><link rel="prefetch" href="/Blog/assets/js/52.89262c74.js"><link rel="prefetch" href="/Blog/assets/js/53.47860fb3.js"><link rel="prefetch" href="/Blog/assets/js/54.4d1f45ac.js"><link rel="prefetch" href="/Blog/assets/js/55.b2dac113.js"><link rel="prefetch" href="/Blog/assets/js/56.34c7045e.js"><link rel="prefetch" href="/Blog/assets/js/57.d614f134.js"><link rel="prefetch" href="/Blog/assets/js/58.e88fc109.js"><link rel="prefetch" href="/Blog/assets/js/59.d386972e.js"><link rel="prefetch" href="/Blog/assets/js/6.e72b2b73.js"><link rel="prefetch" href="/Blog/assets/js/60.a3d054ef.js"><link rel="prefetch" href="/Blog/assets/js/61.27b0d020.js"><link rel="prefetch" href="/Blog/assets/js/62.742bc712.js"><link rel="prefetch" href="/Blog/assets/js/63.0cf87451.js"><link rel="prefetch" href="/Blog/assets/js/65.2a3e00d6.js"><link rel="prefetch" href="/Blog/assets/js/66.c16d7376.js"><link rel="prefetch" href="/Blog/assets/js/67.22d5664d.js"><link rel="prefetch" href="/Blog/assets/js/68.3163821e.js"><link rel="prefetch" href="/Blog/assets/js/69.ba149287.js"><link rel="prefetch" href="/Blog/assets/js/7.8d9b6daa.js"><link rel="prefetch" href="/Blog/assets/js/70.79b3941c.js"><link rel="prefetch" href="/Blog/assets/js/71.9633a5fc.js"><link rel="prefetch" href="/Blog/assets/js/72.0a582a8b.js"><link rel="prefetch" href="/Blog/assets/js/8.f72dab87.js"><link rel="prefetch" href="/Blog/assets/js/9.db5433a8.js">
    <link rel="stylesheet" href="/Blog/assets/css/0.styles.582bb75b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Blog/" class="home-link router-link-active"><!----> <span class="site-name">WolfBerry</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Blog/blog/" class="nav-link">
  Blog
</a></div><div class="nav-item"><a href="/Blog/ugly/" class="nav-link router-link-active">
  Ugly
</a></div><div class="nav-item"><a href="/Blog/gold/" class="nav-link">
  Gold
</a></div><div class="nav-item"><a href="/Blog/diary/" class="nav-link">
  Diary
</a></div> <a href="https://github.com/Real102/Blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Blog/blog/" class="nav-link">
  Blog
</a></div><div class="nav-item"><a href="/Blog/ugly/" class="nav-link router-link-active">
  Ugly
</a></div><div class="nav-item"><a href="/Blog/gold/" class="nav-link">
  Gold
</a></div><div class="nav-item"><a href="/Blog/diary/" class="nav-link">
  Diary
</a></div> <a href="https://github.com/Real102/Blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Ugly</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Blog/ugly/" aria-current="page" class="sidebar-link">介绍</a></li><li><a href="/Blog/ugly/2021.8.html" class="sidebar-link">2021.8</a></li><li><a href="/Blog/ugly/2021.9.html" class="sidebar-link">2021.9</a></li><li><a href="/Blog/ugly/2021.10.html" class="sidebar-link">2021.10</a></li><li><a href="/Blog/ugly/2021.11.html" class="sidebar-link">2021.11</a></li><li><a href="/Blog/ugly/2021.12.html" class="sidebar-link">2021.12</a></li><li><a href="/Blog/ugly/2022.1.html" class="sidebar-link">2022.1</a></li><li><a href="/Blog/ugly/2022.2.html" class="sidebar-link">2022.2</a></li><li><a href="/Blog/ugly/2022.3.html" class="sidebar-link">2022.3</a></li><li><a href="/Blog/ugly/2022.4.html" class="sidebar-link">2022.4</a></li><li><a href="/Blog/ugly/2022.5.html" aria-current="page" class="active sidebar-link">2022.5</a></li><li><a href="/Blog/ugly/2022.6.html" class="sidebar-link">2022.6</a></li><li><a href="/Blog/ugly/2022.7.html" class="sidebar-link">2022.7</a></li><li><a href="/Blog/ugly/2023.1.html" class="sidebar-link">2023.1</a></li><li><a href="/Blog/ugly/2023.2.html" class="sidebar-link">2023.2</a></li><li><a href="/Blog/ugly/测试用例.html" class="sidebar-link">测试用例</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="笔记"><a href="#笔记" class="header-anchor">#</a> 笔记</h1> <h2 id="_2022-年-5-月-1-日"><a href="#_2022-年-5-月-1-日" class="header-anchor">#</a> 2022 年 5 月 1 日</h2> <h3 id="typeof"><a href="#typeof" class="header-anchor">#</a> typeof</h3> <p>在 <code>typescript</code> 中，<code>typeof</code> 可以用来获取一个变量声明或对象的类型</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">interface</span> <span class="token class-name">IPerson</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span>
  age<span class="token operator">:</span> <span class="token builtin">number</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> someone<span class="token operator">:</span> IPerson <span class="token operator">=</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">&quot;张三&quot;</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">21</span> <span class="token punctuation">}</span>
<span class="token keyword">type</span> <span class="token class-name">IMan</span> <span class="token operator">=</span> <span class="token keyword">typeof</span> someone <span class="token comment">// -&gt; IPerson</span>
</code></pre></div><p>也可以用来获取函数对象的类型</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">function</span> <span class="token function">getString</span><span class="token punctuation">(</span>str<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> str <span class="token operator">+</span> <span class="token string">&quot;&quot;</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> <span class="token class-name">Func</span> <span class="token operator">=</span> <span class="token keyword">typeof</span> getString <span class="token comment">// -&gt; (str: number) =&gt; string</span>
</code></pre></div><h2 id="_2022-年-5-月-2-日"><a href="#_2022-年-5-月-2-日" class="header-anchor">#</a> 2022 年 5 月 2 日</h2> <h3 id="keyof"><a href="#keyof" class="header-anchor">#</a> keyof</h3> <p><code>keyof</code> 操作符可以捕获一个类型的键，如捕获变量的键的名称，用法如下：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">const</span> colors <span class="token operator">=</span> <span class="token punctuation">{</span>
  red<span class="token operator">:</span> <span class="token string">&quot;red&quot;</span><span class="token punctuation">,</span>
  blue<span class="token operator">:</span> <span class="token string">&quot;blue&quot;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 首先通过 typeof 操作符获取 colors 变量的类型，然后通过 keyof 操作符获取该类型的所有键：'red' | 'blue'</span>
<span class="token keyword">type</span> <span class="token class-name">Colors</span> <span class="token operator">=</span> <span class="token keyword">keyof</span> <span class="token keyword">typeof</span> colors
<span class="token keyword">let</span> color<span class="token operator">:</span> Colors
color <span class="token operator">=</span> <span class="token string">&quot;red&quot;</span> <span class="token comment">// Ok</span>
color <span class="token operator">=</span> <span class="token string">&quot;blue&quot;</span> <span class="token comment">// Ok</span>
color <span class="token operator">=</span> <span class="token string">&quot;anythingElse&quot;</span> <span class="token comment">// Error</span>
</code></pre></div><p><a href="https://jkchao.github.io/typescript-book-chinese/typings/movingTypes.html#%E6%8D%95%E8%8E%B7%E9%94%AE%E7%9A%84%E5%90%8D%E7%A7%B0" target="_blank" rel="noopener noreferrer">案例来源<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="_2022-年-5-月-3-日"><a href="#_2022-年-5-月-3-日" class="header-anchor">#</a> 2022 年 5 月 3 日</h2> <h3 id="泛型和泛型约束案例之一"><a href="#泛型和泛型约束案例之一" class="header-anchor">#</a> 泛型和泛型约束案例之一</h3> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">function</span> <span class="token function">prop</span><span class="token punctuation">(</span>obj<span class="token operator">:</span> object<span class="token punctuation">,</span> key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>在上面代码中，为了避免调用 <code>prop</code> 函数时传入错误的参数类型，我们为 <code>obj</code> 和 <code>key</code> 参数设置了类型，分别为 <code>{}</code> 和 <code>string</code> 类型。但实际上并没有那么简单，以上代码经过 <code>ts</code> 编译后会报以下错误</p> <div class="language-txt extra-class"><pre class="language-text"><code>Element implicitly has an 'any' type because expression of type 'string' can't be used to index type '{}'
</code></pre></div><p>元素隐式地拥有 <code>any</code> 类型，因为 <code>string</code> 类型不能被用于索引 <code>{}</code> 类型。要解决这个问题，你可以使用以下非常暴力的方案：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">function</span> <span class="token function">prop</span><span class="token punctuation">(</span>obj<span class="token operator">:</span> object<span class="token punctuation">,</span> key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>obj <span class="token keyword">as</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token punctuation">[</span>key<span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>很明显该方案并不是一个好的方案，我们来回顾一下 <code>prop</code> 函数的作用，该函数用于获取某个对象中指定属性的属性值。因此我们期望用户输入的属性是对象上已存在的属性，那么如何限制属性名的范围呢？这时我们可以利用 <code>keyof</code> 操作符：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">function</span> <span class="token generic-function"><span class="token function">prop</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> object<span class="token punctuation">,</span> <span class="token constant">K</span> <span class="token keyword">extends</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>obj<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">,</span> key<span class="token operator">:</span> <span class="token constant">K</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>首先定义了 <code>T</code> 类型并使用 <code>extends</code> 关键字约束该类型必须是 <code>object</code> 类型的子类型，然后使用 <code>keyof</code> 操作符获取 <code>T</code> 类型的所有键，其返回类型是联合类型，最后利用 <code>extends</code> 关键字约束 <code>K</code> 类型必须为 <code>keyof T</code> 联合类型的子类型。</p> <p><a href="https://mp.weixin.qq.com/s?__biz=MzI2MjcxNTQ0Nw==&amp;mid=2247484077&amp;idx=1&amp;sn=1215e14604232f1da0031dc3ee4f0b82&amp;chksm=ea47a3f5dd302ae3c89633513fb8c0de72458a1915bb2a079e7961a2f4ea198afc4dc8d4c62e&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">案例来源<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="_2022-年-5-月-4-日"><a href="#_2022-年-5-月-4-日" class="header-anchor">#</a> 2022 年 5 月 4 日</h2> <h3 id="内置类型别名之-partial-required"><a href="#内置类型别名之-partial-required" class="header-anchor">#</a> 内置类型别名之 Partial &amp;&amp; Required</h3> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token comment">// Make all properties in T optional</span>
<span class="token keyword">type</span> <span class="token class-name">Partial<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">?</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token comment">// Make all properties in T required</span>
<span class="token keyword">type</span> <span class="token class-name">Required<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">?</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>如上代码所示，<code>Partial&lt;T&gt;</code> 的作用是将某个类型中的所有属性都变成可选属性；而 <code>Required&lt;T&gt;</code> 的作用则是将某个类型中的可选属性都变成必选属性，其中 <code>-?</code> 表示移除可选项 <code>?</code></p> <p>示例：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">IResult</span> <span class="token punctuation">{</span>
  code<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span>
  message<span class="token operator">:</span> <span class="token builtin">string</span>
  data<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> <span class="token class-name">IResultPartial</span> <span class="token operator">=</span> Partial<span class="token operator">&lt;</span>IResult<span class="token operator">&gt;</span>
<span class="token keyword">type</span> <span class="token class-name">IResultRequired</span> <span class="token operator">=</span> Required<span class="token operator">&lt;</span>IResult<span class="token operator">&gt;</span>

<span class="token comment">// 结果</span>
<span class="token comment">// type IResultPartial = {</span>
<span class="token comment">//     code?: number | undefined;</span>
<span class="token comment">//     message?: string | undefined;</span>
<span class="token comment">//     data?: string | undefined;</span>
<span class="token comment">// }</span>

<span class="token comment">// type IResultRequired = {</span>
<span class="token comment">//     code: number;</span>
<span class="token comment">//     message: string;</span>
<span class="token comment">//     data: string;</span>
<span class="token comment">// }</span>
</code></pre></div><h2 id="_2022-年-5-月-5-日"><a href="#_2022-年-5-月-5-日" class="header-anchor">#</a> 2022 年 5 月 5 日</h2> <h3 id="内置类型别名之-exclude-extract"><a href="#内置类型别名之-exclude-extract" class="header-anchor">#</a> 内置类型别名之 Exclude &amp;&amp; Extract</h3> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token comment">// Exclude from T those types that are assignable to U</span>
<span class="token keyword">type</span> <span class="token class-name">Exclude<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">U</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token constant">U</span></span> <span class="token operator">?</span> <span class="token builtin">never</span> <span class="token operator">:</span> <span class="token constant">T</span>

<span class="token comment">// Extract from T those types that are assignable to U</span>
<span class="token keyword">type</span> <span class="token class-name">Extract<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">U</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token constant">U</span></span> <span class="token operator">?</span> <span class="token constant">T</span> <span class="token operator">:</span> <span class="token builtin">never</span>
</code></pre></div><p>如上代码所示，<code>Exclude&lt;T, U&gt;</code> 的作用是将 <code>T</code> 类型中属于 <code>U</code> 类型的属性移除掉；而 <code>Extract&lt;T, U&gt;</code> 则是从 <code>T</code> 中提取出 <code>U</code></p> <p>注意以上 <code>extends</code> 的作用为类型约束，当 <code>T</code> 是 <code>U</code> 的子类型时，<code>T extends U</code> 返回的是 <code>true</code>，否则返回 <code>false</code></p> <p>示例：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">interface</span> <span class="token class-name"><span class="token constant">T1</span></span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span>
  age<span class="token operator">:</span> <span class="token builtin">number</span>
  email<span class="token operator">:</span> <span class="token builtin">string</span>
  phone<span class="token operator">:</span> <span class="token builtin">number</span>
<span class="token punctuation">}</span>
<span class="token keyword">interface</span> <span class="token class-name"><span class="token constant">T2</span></span> <span class="token punctuation">{</span>
  email<span class="token operator">:</span> <span class="token builtin">string</span>
  phone<span class="token operator">:</span> <span class="token builtin">number</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T3</span></span> <span class="token operator">=</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span> <span class="token operator">|</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T4</span></span> <span class="token operator">=</span> <span class="token builtin">string</span>

<span class="token comment">// 需要区分联合类型与接口的区别</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T5</span></span> <span class="token operator">=</span> Exclude<span class="token operator">&lt;</span><span class="token keyword">keyof</span> <span class="token constant">T1</span><span class="token punctuation">,</span> <span class="token keyword">keyof</span> <span class="token constant">T2</span><span class="token operator">&gt;</span> <span class="token comment">// -&gt; type T5 = &quot;name&quot; | &quot;age&quot;</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T6</span></span> <span class="token operator">=</span> Exclude<span class="token operator">&lt;</span><span class="token constant">T3</span><span class="token punctuation">,</span> <span class="token constant">T4</span><span class="token operator">&gt;</span> <span class="token comment">// -&gt; type T6 = number | number[]</span>

<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T7</span></span> <span class="token operator">=</span> Extract<span class="token operator">&lt;</span><span class="token keyword">keyof</span> <span class="token constant">T1</span><span class="token punctuation">,</span> <span class="token keyword">keyof</span> <span class="token constant">T2</span><span class="token operator">&gt;</span> <span class="token comment">// -&gt; type T7 = &quot;email&quot; | &quot;phone&quot;</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T8</span></span> <span class="token operator">=</span> Extract<span class="token operator">&lt;</span><span class="token constant">T3</span><span class="token punctuation">,</span> <span class="token constant">T4</span><span class="token operator">&gt;</span> <span class="token comment">// -&gt; type T8 = string</span>
</code></pre></div><h2 id="_2022-年-5-月-6-日"><a href="#_2022-年-5-月-6-日" class="header-anchor">#</a> 2022 年 5 月 6 日</h2> <h3 id="内置类型别名之-pick-omit"><a href="#内置类型别名之-pick-omit" class="header-anchor">#</a> 内置类型别名之 Pick &amp;&amp; Omit</h3> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token comment">// From T, pick a set of properties whose keys are in the union K</span>
<span class="token keyword">type</span> <span class="token class-name">Pick<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">K</span> <span class="token keyword">extends</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token constant">K</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token comment">// Construct a type with the properties of T except for those in type K.</span>
<span class="token keyword">type</span> <span class="token class-name">Omit<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">K</span> <span class="token keyword">extends</span> <span class="token keyword">keyof</span> <span class="token builtin">any</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> Pick<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> Exclude<span class="token operator">&lt;</span><span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">K</span><span class="token operator">&gt;&gt;</span>
</code></pre></div><p>如上代码所示，<code>Pick&lt;T, K extends keyof T&gt;</code> 的作用是将 <code>T</code> 中的子类型 <code>K</code> 提取出来；<code>Omit&lt;T, K extends keyof any&gt;</code> 的作用则是将 T 中除 K 类型以外的所有属性</p> <p>示例：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">interface</span> <span class="token class-name"><span class="token constant">T1</span></span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span>
  age<span class="token operator">:</span> <span class="token builtin">number</span>
  email<span class="token operator">:</span> <span class="token builtin">string</span>
  phone<span class="token operator">:</span> <span class="token builtin">number</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name"><span class="token constant">T2</span></span> <span class="token punctuation">{</span>
  email<span class="token operator">:</span> <span class="token builtin">string</span>
  phone<span class="token operator">:</span> <span class="token builtin">number</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T3</span></span> <span class="token operator">=</span> <span class="token string">&quot;email&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;phone&quot;</span>

<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T5</span></span> <span class="token operator">=</span> Pick<span class="token operator">&lt;</span><span class="token constant">T1</span><span class="token punctuation">,</span> <span class="token keyword">keyof</span> <span class="token constant">T2</span><span class="token operator">&gt;</span> <span class="token comment">// -&gt; type T5 = { email: string; phone: number; }</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T6</span></span> <span class="token operator">=</span> Pick<span class="token operator">&lt;</span><span class="token constant">T1</span><span class="token punctuation">,</span> <span class="token constant">T3</span><span class="token operator">&gt;</span> <span class="token comment">// -&gt; type T6 = { email: string; phone: number; }</span>

<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T7</span></span> <span class="token operator">=</span> Omit<span class="token operator">&lt;</span><span class="token constant">T1</span><span class="token punctuation">,</span> <span class="token keyword">keyof</span> <span class="token constant">T2</span><span class="token operator">&gt;</span> <span class="token comment">// -&gt; type T7 = { name: string; age: number; }</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T8</span></span> <span class="token operator">=</span> Omit<span class="token operator">&lt;</span><span class="token constant">T1</span><span class="token punctuation">,</span> <span class="token constant">T3</span><span class="token operator">&gt;</span> <span class="token comment">// -&gt; type T8 = { name: string; age: number; }</span>
</code></pre></div><h2 id="_2022-年-5-月-7-日"><a href="#_2022-年-5-月-7-日" class="header-anchor">#</a> 2022 年 5 月 7 日</h2> <h3 id="ts-中的-extends-关键字"><a href="#ts-中的-extends-关键字" class="header-anchor">#</a> TS 中的 extends 关键字</h3> <p><a href="https://cloud.tencent.com/developer/article/1884330" target="_blank" rel="noopener noreferrer">参考文档地址<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="_2022-年-5-月-8-日"><a href="#_2022-年-5-月-8-日" class="header-anchor">#</a> 2022 年 5 月 8 日</h2> <h3 id="const-断言"><a href="#const-断言" class="header-anchor">#</a> const 断言</h3> <h2 id="_2022-年-5-月-9-日"><a href="#_2022-年-5-月-9-日" class="header-anchor">#</a> 2022 年 5 月 9 日</h2> <h3 id="协变与逆变"><a href="#协变与逆变" class="header-anchor">#</a> 协变与逆变</h3> <h2 id="_2022-年-5-月-10-日"><a href="#_2022-年-5-月-10-日" class="header-anchor">#</a> 2022 年 5 月 10 日</h2> <h3 id="readonly-const"><a href="#readonly-const" class="header-anchor">#</a> readonly &amp; const</h3> <p>参考文档：</p> <ul><li><a href="https://www.typescriptlang.org/docs/handbook/2/objects.html#readonly-properties" target="_blank" rel="noopener noreferrer">https://www.typescriptlang.org/docs/handbook/2/objects.html#readonly-properties<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.typescriptlang.org/docs/handbook/2/objects.html#readonly-tuple-types" target="_blank" rel="noopener noreferrer">https://www.typescriptlang.org/docs/handbook/2/objects.html#readonly-tuple-types<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="_2022-年-5-月-11-日"><a href="#_2022-年-5-月-11-日" class="header-anchor">#</a> 2022 年 5 月 11 日</h2> <h3 id="泛型、泛型接口、泛型类、非泛型函数签名"><a href="#泛型、泛型接口、泛型类、非泛型函数签名" class="header-anchor">#</a> 泛型、泛型接口、泛型类、非泛型函数签名？</h3> <h2 id="_2022-年-5-月-12-日"><a href="#_2022-年-5-月-12-日" class="header-anchor">#</a> 2022 年 5 月 12 日</h2> <h3 id="ts-中的-infer-关键字"><a href="#ts-中的-infer-关键字" class="header-anchor">#</a> ts 中的 infer 关键字</h3> <p><code>infer</code> 关键字是在 <code>2.8</code> 版本中新增的，在<strong>有条件类型的 <code>extends</code> 子语句中，允许出现 <code>infer</code> 声明</strong>，它会引入一个待推断的类型变量。 这个推断的类型变量可以在有条件类型的 <code>true</code> 分支中被引用。 允许出现多个同类型变量的 <code>infer</code>。</p> <p>如下代码会提取函数类型的返回值类型：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token comment">// 例1：</span>
<span class="token keyword">type</span> <span class="token class-name">ReturnType<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> infer <span class="token constant">R</span> <span class="token operator">?</span> <span class="token constant">R</span> <span class="token operator">:</span> <span class="token builtin">any</span>
<span class="token comment">// infer R 为 待推断的返回类型</span>

<span class="token comment">// 例2：</span>
<span class="token keyword">type</span> <span class="token class-name">ParamType<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span>param<span class="token operator">:</span> infer <span class="token constant">R</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">any</span> <span class="token operator">?</span> <span class="token constant">R</span> <span class="token operator">:</span> <span class="token constant">T</span>
</code></pre></div><p>大白话理解即为：如果例 1 中的 <code>T</code> 能赋值于 <code>(...args: any[]) =&gt; infer R</code>，那么 <code>infer R</code> 就是 <code>T</code> 的返回类型；如果例 2 中的 <code>T</code> 能赋值于 <code>(param: infer R) =&gt; any</code> 那么 <code>infer R</code> 就是参数 <code>param</code> 的类型</p> <p>加深理解：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">type</span> <span class="token class-name">Unpacked<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span>infer <span class="token constant">U</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment">// 指待推断的数组类型</span>
  <span class="token operator">?</span> <span class="token constant">U</span>
  <span class="token operator">:</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> infer <span class="token constant">U</span> <span class="token comment">// 指待推断的函数返回值类型</span>
  <span class="token operator">?</span> <span class="token constant">U</span>
  <span class="token operator">:</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token builtin">Promise</span><span class="token operator">&lt;</span>infer <span class="token constant">U</span><span class="token operator">&gt;</span></span> <span class="token comment">// 指待推断的参数类型</span>
  <span class="token operator">?</span> <span class="token constant">U</span>
  <span class="token operator">:</span> <span class="token constant">T</span>

<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T0</span></span> <span class="token operator">=</span> Unpacked<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">&gt;</span> <span class="token comment">// string</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T1</span></span> <span class="token operator">=</span> Unpacked<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> <span class="token comment">// string</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T2</span></span> <span class="token operator">=</span> Unpacked<span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">string</span><span class="token operator">&gt;</span> <span class="token comment">// string</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T3</span></span> <span class="token operator">=</span> Unpacked<span class="token operator">&lt;</span><span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">&gt;&gt;</span> <span class="token comment">// string</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T4</span></span> <span class="token operator">=</span> Unpacked<span class="token operator">&lt;</span><span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">&gt;</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> <span class="token comment">// Promise&lt;string&gt;</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T5</span></span> <span class="token operator">=</span> Unpacked<span class="token operator">&lt;</span>Unpacked<span class="token operator">&lt;</span><span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">&gt;</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span> <span class="token comment">// string</span>
</code></pre></div><p>参考文档：</p> <ul><li><a href="https://www.tslang.cn/docs/release-notes/typescript-2.8.html" target="_blank" rel="noopener noreferrer">https://www.tslang.cn/docs/release-notes/typescript-2.8.html<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="_2022-年-5-月-13-日"><a href="#_2022-年-5-月-13-日" class="header-anchor">#</a> 2022 年 5 月 13 日</h2> <h3 id="内置类型别名之-returntype"><a href="#内置类型别名之-returntype" class="header-anchor">#</a> 内置类型别名之：ReturnType</h3> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token comment">// Obtain the return type of a function type</span>
<span class="token keyword">type</span> <span class="token class-name">ReturnType<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span></span> <span class="token builtin">any</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> infer <span class="token constant">R</span> <span class="token operator">?</span> <span class="token constant">R</span> <span class="token operator">:</span> <span class="token builtin">any</span>
</code></pre></div><p>如上代码所示，<code>ReturnType&lt;T&gt;</code> 主要用于获取函数返回值类型</p> <p>更多示例：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">function</span> <span class="token function">f1</span><span class="token punctuation">(</span>s<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> b<span class="token operator">:</span> s <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T1</span></span> <span class="token operator">=</span> ReturnType<span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">string</span><span class="token operator">&gt;</span> <span class="token comment">// string</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T2</span></span> <span class="token operator">=</span> ReturnType<span class="token operator">&lt;</span><span class="token punctuation">(</span>s<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token operator">&gt;</span> <span class="token comment">// void</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T3</span></span> <span class="token operator">=</span> ReturnType<span class="token operator">&lt;&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token constant">T</span><span class="token operator">&gt;</span> <span class="token comment">// unknown ？ {}</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T4</span></span> <span class="token operator">=</span> ReturnType<span class="token operator">&lt;&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token constant">U</span></span><span class="token punctuation">,</span> <span class="token constant">U</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token builtin">number</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token constant">T</span><span class="token operator">&gt;</span> <span class="token comment">// number[]</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T5</span></span> <span class="token operator">=</span> ReturnType<span class="token operator">&lt;</span><span class="token keyword">typeof</span> f1<span class="token operator">&gt;</span> <span class="token comment">// { a: number, b: string }</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T6</span></span> <span class="token operator">=</span> ReturnType<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">&gt;</span> <span class="token comment">// any</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T7</span></span> <span class="token operator">=</span> ReturnType<span class="token operator">&lt;</span><span class="token builtin">never</span><span class="token operator">&gt;</span> <span class="token comment">// never？any</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T8</span></span> <span class="token operator">=</span> ReturnType<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">&gt;</span> <span class="token comment">// Error</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T9</span></span> <span class="token operator">=</span> ReturnType<span class="token operator">&lt;</span><span class="token builtin">Function</span><span class="token operator">&gt;</span> <span class="token comment">// Error</span>
</code></pre></div><h2 id="_2022-年-5-月-24-日"><a href="#_2022-年-5-月-24-日" class="header-anchor">#</a> 2022 年 5 月 24 日</h2> <h2 id="object-keys-遍历赋值"><a href="#object-keys-遍历赋值" class="header-anchor">#</a> Object.keys 遍历赋值</h2> <p>如下栗子，在 <code>js</code> 中我们经常用 <code>Object.keys</code> 获取一个对象的属性进行遍历赋值，但是在 ts 中使用会提示异常</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">type</span> <span class="token class-name">IObj</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  a<span class="token operator">:</span> <span class="token builtin">number</span>
  b<span class="token operator">:</span> <span class="token builtin">string</span>
  c<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> obj<span class="token operator">:</span> IObj <span class="token operator">=</span> <span class="token punctuation">{</span>
  a<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  b<span class="token operator">:</span> <span class="token string">&quot;2&quot;</span><span class="token punctuation">,</span>
  c<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
  a<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
  b<span class="token operator">:</span> <span class="token string">&quot;string&quot;</span><span class="token punctuation">,</span>
  c<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  d<span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>

Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>key <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 报错</span>
  obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 异常信息 -&gt;</span>
<span class="token comment">// Element implicitly has an 'any' type because expression of type 'string' can't be used to index type 'IObj'.</span>
<span class="token comment">// No index signature with a parameter of type 'string' was found on type 'IObj'.</span>

<span class="token comment">// Element implicitly has an 'any' type because expression of type 'string' can't be used to index type '{ a: number; b: string; c: number[]; d: boolean; }'.</span>
<span class="token comment">// No index signature with a parameter of type 'string' was found on type '{ a: number; b: string; c: number[]; d: boolean; }'.</span>
</code></pre></div><p>在 <code>Object.keys</code> 获取到的属性 <code>list</code> 其实是 <code>string[]</code>，而非 <code>(keyof IObj)[]</code>，因此需要再使用类型断言</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>key <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  obj<span class="token punctuation">[</span>key <span class="token keyword">as</span> <span class="token keyword">keyof</span> IObj<span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 可能在playground仍然会报下面这个异常，这时只需要给obj加上 as any 断言即可</span>
<span class="token comment">// Type 'any' is not assignable to type 'never'</span>

Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>key <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token punctuation">;</span><span class="token punctuation">(</span>obj <span class="token keyword">as</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token punctuation">[</span>key <span class="token keyword">as</span> <span class="token keyword">keyof</span> IObj<span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>写成方法则如下：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">function</span> <span class="token generic-function"><span class="token function">traversalAssign</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> object<span class="token punctuation">,</span> <span class="token constant">Q</span> <span class="token keyword">extends</span> object<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>obj1<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">,</span> obj2<span class="token operator">:</span> <span class="token constant">Q</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>obj1<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>key <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    obj1<span class="token punctuation">[</span>key <span class="token keyword">as</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>obj2 <span class="token keyword">as</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token punctuation">[</span>key<span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 或</span>

<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">traversalAssign</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">Q</span> <span class="token keyword">extends</span> object<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>obj1<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">,</span> obj2<span class="token operator">:</span> <span class="token constant">Q</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> item<span class="token operator">:</span> <span class="token keyword">keyof</span> <span class="token constant">T</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span>item <span class="token keyword">in</span> obj1<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    obj1<span class="token punctuation">[</span>item<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>obj2 <span class="token keyword">as</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token punctuation">[</span>item<span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/Real102/Blog/edit/master/docs/ugly/2022.5.md" target="_blank" rel="noopener noreferrer">Edit in GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">7/22/2022, 10:08:22 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/Blog/ugly/2022.4.html" class="prev">
        2022.4
      </a></span> <span class="next"><a href="/Blog/ugly/2022.6.html">
        2022.6
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/Blog/assets/js/app.26c94a5c.js" defer></script><script src="/Blog/assets/js/2.b2fff99d.js" defer></script><script src="/Blog/assets/js/64.ee8cefe2.js" defer></script>
  </body>
</html>
