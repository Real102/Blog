# require.context çš„å¦™ç”¨

## å‰è¨€

æˆ‘ä»¬åœ¨å¼€å‘ vue é¡¹ç›®æ—¶ï¼Œä¸€èˆ¬éƒ½ä¼šåˆ©ç”¨ä¸€äº›å…¨å±€ç»„ä»¶ã€Vuex ç­‰è¿›è¡Œè¾…åŠ©å¼€å‘ï¼Œæ—¶é—´ä¹…äº†ï¼Œä½¿ç”¨çš„è¾…åŠ©å·¥å…·ç­‰ä¼šè¶Šæ¥è¶Šå¤šï¼Œæ¯æ–°å¢ä¸€ä¸ªéƒ½è¦ importã€ exportï¼Œ éå¸¸çš„éº»çƒ¦å¹¶ä¸”ä¸æ–¹ä¾¿ç®¡ç†ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±éœ€è¦å€ŸåŠ© webpack æä¾›çš„ä¸€ä¸ªå‡½æ•°ï¼š`require.context()`æ¥å¸®åŠ©è‡ªå·±ç®¡ç†è¿™äº›æ’ä»¶

ä½¿ç”¨ require.context è‡ªåŠ¨å¯¼å…¥æŒ‡å®šç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶

### require.context(directory, useSubdirectories, RegExp, mode)

`directory:` æŒ‡å®šçš„æ–‡ä»¶ç›®å½•ï¼Œå¯ä»¥æ˜¯ç›¸å¯¹è·¯å¾„/ç»å¯¹è·¯å¾„  
`useSubdirectories:` æ˜¯å¦éå†è¯¥ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼ˆBooleanï¼‰  
`regExp:` æ­£åˆ™è¡¨è¾¾å¼ï¼Œç”¨äºåŒ¹é…æ–‡ä»¶

æ­¤å¤–`require.context()`è¿˜æœ‰ä¸‰ä¸ªå±æ€§ï¼š

`resolve` æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒè¿”å›è¢«è§£æåå¾—åˆ°çš„æ¨¡å— id  
`keys` ä¹Ÿæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒè¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…æ‹¬æ‰€æœ‰å¯èƒ½è¢«æ­¤ context module å¤„ç†çš„è¯·æ±‚ï¼ˆä¸»è¦å€ŸåŠ©è¿™ä¸ªå±æ€§æ¥å¯¹æ–‡ä»¶åšè¿›ä¸€æ­¥å¤„ç†ï¼‰  
`id` æ‰§è¡Œç¯å¢ƒçš„ idï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²

### ä½¿ç”¨åœºæ™¯

æœ‰å¦‚ä¸‹ç›®å½•ç»“æ„åŠå¯¹åº”æ–‡ä»¶å†…å®¹

```json
|â€”â€” test
|   |â€”â€” index.js
|   |â€”â€” a.js
|   |â€”â€” b.js
|   â””â”€â”€ c.js
```

```javascript
// a.js
export const func1 = () => {
	return "this is a.js"
}
```

```javascript
// b.js
export const func2 = () => {
	return "this is b.js"
}
```

```javascript
// c.js
export default {
	func3() {
		return "this is c.js"
	}
}
```

```javascript
// index.js
let apiList = {} // å®šä¹‰ä¸´æ—¶å˜é‡ï¼Œç”¨äºå­˜å‚¨æš´éœ²å‡ºçš„å‡½æ•°
let context = require.context("./", false, /\.js$/)
context.keys().forEach(item => {
	// index.jsåˆšå¥½ä¸å…¶ä»–æ–‡ä»¶åŒçº§ï¼Œéœ€è¦è¿‡æ»¤ï¼Œå› ä¸ºè¿™ä¸ªæ–‡ä»¶ä¸å¯¼å‡ºä»»ä½•å˜é‡æˆ–æ–¹æ³•
	if (item === "./index.js") return
	// å½“æ¨¡å—æ˜¯ä»¥export defaultæ–¹å¼å¯¼å‡ºï¼Œä¼šæŒ‚åœ¨defaultå±æ€§ä¸‹ï¼Œéœ€è¦ç‰¹åˆ«å¤„ç†
	let temp = context(item).default || context(item)
	// Object.assignï¼šå¦‚æœç›®æ ‡å¯¹è±¡ä¸æºå¯¹è±¡æœ‰åŒåå±æ€§ï¼Œæˆ–å¤šä¸ªæºå¯¹è±¡æœ‰åŒåå±æ€§ï¼Œåˆ™åé¢çš„å±æ€§è¦†ç›–å‰é¢çš„å±æ€§
	// ç¡®ä¿æŒ‡å®šç›®å½•ä¸‹æš´éœ²çš„æ‰€æœ‰æ–¹æ³•éƒ½ä¸é‡å
	Object.assign(apiList, temp)
})
// console.log(apiList)
```

è‡³æ­¤å°±å·²ç»æŠŠ `./` å½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶æš´éœ²å‡ºçš„å˜é‡æˆ–æ–¹æ³•éƒ½å·²ç»å­˜åœ¨ `apiList`ï¼Œè¿™æ ·å°±å¯ä»¥åšç»Ÿä¸€æ“ä½œï¼Œé¿å…é‡å¤å†™ import

## å‚è€ƒæ–‡æ¡£

-   [webpack ä¸­æ–‡æ–‡æ¡£ ğŸš€](https://webpack.docschina.org/guides/dependency-management/#requirecontext)
