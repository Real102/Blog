# 笔记

## 2021 年 9 月 1 日

### this.\$options

用于当前 Vue 实例的初始化选项，相当于实例的所有选项中的所有初始数据都保存了一个快照，包括 `data`、`methods` 等

小技巧：在表单提交页中，初始化表单数据，可以使用 `this.$options.data().formData` 获取到初始值再赋值

## 2021 年 9 月 2 日

### opener、referrer

`opener`：返回打开当前窗口的那个窗口的引用，默认需要设置为 `null`，否则可以获取原页面 `window` 的“控制权”
`referrer`：返回一个 `URL`，代表当前页面是从这个 `URL` 页面跳转或打开的（注意区分 `HTML` 的 `referrer` 和 `Http` 请求头的 `referrer`）

Tips：
`HTML` 的 `referrer` 有以下几种策略：[no-referrer|no-referrer-when-downgrade|origin|origin-when-downgrade|strict-origin-when-cross-origin|unsafe-url 🚀](https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/a)
`Http` 的 `referrer` 可以手动设置

## 2021 年 9 月 3 日

### storage 事件

对 `storage` 对象进行任何修改，都会在文档上触发 `storage` 事件，包括：`getItem`、`setItem`、`clear`、`delete`

`storage` 事件整体兼容性较好，但 `Safari` 浏览器较差，部分功能 `api` 完全不支持

[storage 兼容性 🚀](https://caniuse.com/?search=storage)

### progress

`filereader` 的 `progress` 事件约 `50ms` 触发一次

## 2021 年 9 月 4 日

### document.hidden

表示页面是否隐藏的属性，基本兼容主流浏览器（低版本除外）。当文档可见性发生改变时会触发 `visibilitychange` 事件（`Safari` 兼容性未知，需要加前缀）

使用时需要注意检测 `api` 的兼容性

例: 切换标签页时，更改原标签页的标题

[document.hidden 兼容性 🚀](https://caniuse.com/?search=document.hidden)
[visibilitychange 兼容性 🚀](https://caniuse.com/?search=visibilitychange)

## 2021 年 9 月 5 日

## indexedDB

浏览器中保存结构化数据的一种数据库，操作完全是异步进行的，因此都需要注册事件监听（`onsuccess`、`onerror`）

`indexedDB` 的思想是创建一套 `api`，方便保存和读取 **`JavaScript` 对象**，同时还支持查询和搜索

兼容性：需要提供浏览器内核前缀 `indexedDB`| `msIndexedDB` | `webkitIndexedDB`| `mozIndexedDB`

## 2021 年 9 月 6 日

### 性能优化

1. 注意作用域：避免全局查找；避免 `with` 语句（会创建内部的作用域）
2. 选择正确的方法：避免不必要的属性查找；优化循环；展开循环；避免双重解释
3. 最小化语句数：多个变量声明；插入迭代值；使用数组和对象字面量
4. 优化 `DOM` 交互：最小化现场更新；使用 `innerHTML`；使用事件代理；最小化访问 `HTMLCollection`

### 时间复杂度 O

| 标记     | 名称 | 描述                                                           |
| -------- | ---- | -------------------------------------------------------------- |
| O(1)     | 常数 | 执行时间恒定，一般表示简单值和存储在变量中的值                 |
| O(n)     | 线性 | 与值的数量直接相关，例：遍历数组的所有元素                     |
| O(log n) | 对数 | 与值得数量相关，但是要完成算法不一定要获取每个值，例：二分查找 |
| O(n2)    | 指数 | 与值得数量相关，每个值至少执行 n 次，例：插入排序              |

1. 使用变量和数组比访问对象上的属性更高效，为 `O(n)`。（需要执行一次搜索，包括原型链）

## 2021 年 9 月 7 日

### Chrome debugger

1. 调试 `vue` 项目时，需要开启 `devtool：source-map`
2. 配置 `launch.json` 文件，参考如下
3. 打断点，启动项目

tips：若断点为灰色空心圆圈，需要检查一下 `source-map` 是否开启；若为红实心圆圈，则可以正常 `debug`

TODO: 其他调试方案？有没有更好玩的玩法？

```json
// 点击调试顶部工具栏的“齿轮”按钮会自动生成一串json，然后再修改为项目适用的配置即可
{
	"version": "0.2.0",
	"configurations": [
		{
			"type": "chrome",
			"request": "launch",
			"name": "运行当前项目",
			"url": "http://localhost:8080",
			"webRoot": "${workspaceFolder}/src",
			"breakOnLoad": true,
			"sourceMapPathOverrides": {
				"webpack:///src/*": "${webRoot}/*"
			}
		}
	]
}
```

## 2021 年 9 月 8 日

### web Worker

-   `worker` 消息内容可以是任何能被序列化的值
-   `worker` 在不能完成既定的任务时会触发 `error` 事件，即在执行过程中遇到了任何错误都会触发 `error` 事件。包含三个属性：发生错误的文件名 `filename`、代码行号 `lineno`、完整的错误信息 `message`
-   `worker` 内部的顶层对象是 `worker` 本身，而非 `window` 对象，并且 `worker` 内部不能对 `DOM` 执行任何操作
-   `importScript('file1.js', 'file2.js')` 方法引入外部 js 文件，所有文件都是异步加载，并且是顺序执行

TODO: 应用场景：文件上传、加解密流程

```javascript
const worker = new Worker("worker.js")
worker.postMessage({ type: "des", message: "start" })
worker.terminate() // 立即停止worker的工作

// worker.js
self.onmessage = e => {
	const { data } = e
}

self.onerror = err => {
	console.log(err.filename + err.lineno + err.message)
}
```

### geolocation

-   获取用户的地理位置，用法暂时还没摸透...准确性也未知...
-   得到的数据是经纬度，这个方法貌似容易崩溃...
-   如果要用百度、高德、腾讯地图等显示出来，应该都需要进行坐标转换，然后才能够显示出来

```javascript
navigator.geolocation.getCurrentPosition(fnsuc, fnerr, {
	enableHighAccuracy: boolean,
	timeout: 5000,
	maximumAge: 25000
})

navigator.geolocation.watchPosition(fnsuc, fnerr)
navigator.geolocation.cleatWatch()
```

### js 红宝书第一遍结束（9.8）

大致花了一个月多时间大致完成阅读...
附录部分略过了...
太基础的也略过了...
暂时接触不到的也略过了...
准备开始 `vue.js` 官网 `2.x` 和 `3.x`...
祈祷 ing...
praying...
祈っている...

## 2021 年 9 月 9 日

### object.freeze

### web components、shadow DOM

## 2021 年 9 月 10 日

缺席...

## 2021 年 9 月 11 日

缺席...

## 2021 年 9 月 12 日

缺席...

## 2021 年 9 月 13 日

### ua 解析工具

1. mobile-detect
2. ua-parser-js

## 2021 年 9 月 14 日

### 啥

## 2021 年 9 月 15 日
